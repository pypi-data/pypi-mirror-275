(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8092],{59396:function(e,t,n){Promise.resolve().then(n.bind(n,12510))},87138:function(e,t,n){"use strict";n.d(t,{default:function(){return s.a}});var a=n(231),s=n.n(a)},12510:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return S}});var a=n(57437),s=n(2265),r=n(88726),l=n(75728),o=n(57818),i=n(98701),c=n(76706),d=n(14088);let u=[{field:"tag",name:"Tag",render:e=>{let{value:t,clear:n}=e;return(0,a.jsx)(i.Z,{field:"Tag",value:"".concat(t.key,": ").concat(t.value),onRemove:n})},selector:e=>{let{setFilter:t}=e;return(0,a.jsx)(c.D3,{onChange:e=>t("tag",e)})},description:"Select sound events that have a given tag",icon:(0,a.jsx)(d.lO,{className:"h-5 w-5 inline-block text-stone-500 mr-1 align-middle"})}];var m=n(37051),f=n(71672),x=n(94776),v=n(2857),h=n(63425),p=n(40127),g=n(35466),j=n(30635);let b={};function w(e){let{items:t,query:n,pagination:r,total:l}=(0,j.Z)({name:"sound_event_annotations_scatter",queryFn:m.Z.soundEventAnnotations.getMany,pageSize:12,filter:e.filter||b}),o=(0,s.useMemo)(()=>t||[],[t]);return n.isLoading?(0,a.jsx)(v.Z,{}):(0,a.jsxs)("div",{className:"flex flex-col gap-2 px-4",children:[(0,a.jsxs)("div",{className:"flex flex-row justify-between items-center",children:[(0,a.jsx)("div",{children:(0,a.jsxs)("span",{className:"text-stone-500",children:["Showing"," ",(0,a.jsxs)("span",{className:"font-bold",children:[r.page*r.pageSize," -"," ",r.page*r.pageSize+o.length]})," ","of ",(0,a.jsx)("span",{className:"text-emerald-500 font-bold",children:l})," sound events"]})}),(0,a.jsx)(h.Z,{...r})]}),(0,a.jsx)("div",{className:"grid grid-cols-4 gap-8",children:o.map(t=>(0,a.jsx)(f.Z,{children:(0,a.jsx)(Z,{annotation:t,parameters:e.parameters,onParametersSave:e.onParametersSave})},t.uuid))}),(0,a.jsx)("div",{className:"flex flex-row justify-center",children:(0,a.jsx)(h.Z,{...r})})]})}function Z(e){let{annotation:t,parameters:n,onParametersSave:s,height:r=260}=e,{recording:{data:l,isLoading:o}}=(0,p.Z)({uuid:t.uuid,soundEventAnnotation:t,withRecording:!0});return o?(0,a.jsx)("div",{className:"w-full flex flex-row items-center justify-center",style:{height:r},children:(0,a.jsx)(v.Z,{})}):null==l?(0,a.jsx)(x.Z,{children:"No recording found "}):(0,a.jsx)(g.Z,{recording:l,soundEventAnnotation:t,parameters:n,onParametersSave:s,height:r,withBar:!1,withPlayer:!1,withControls:!1,withSettings:!1})}var k=n(14396);let N=(0,o.default)(()=>Promise.all([n.e(5934),n.e(7156)]).then(n.bind(n,87156)),{loadableGenerated:{webpack:()=>[87156]},ssr:!1}),y=[{id:"gallery",title:"Gallery",icon:(0,a.jsx)(d.zB,{className:"w-5 h-5"})},{id:"plot",title:"Scatterplot",icon:(0,a.jsx)(d.E6,{className:"w-5 h-5"})}];function C(e){return(0,a.jsx)(k.Z,{description:"Explore all annotated sound events. Use the filtering options to select a subset, and choose the view you wish to use to explore the sound events.",filter:e.filter,filterDef:u,parameters:e.parameters,onParametersSave:e.onParametersSave,tabs:y,children:t=>{let{view:n,filter:s}=t;return"gallery"===n?(0,a.jsx)(w,{filter:s,parameters:e.parameters,onParametersSave:e.onParametersSave}):(0,a.jsx)(N,{filter:s,parameters:e.parameters,onParametersSave:e.onParametersSave})}})}function S(){let e=(0,l.Z)(e=>e.spectrogramSettings),t=(0,l.Z)(e=>e.setSpectrogramSettings),n=(0,s.useCallback)(e=>{r.ZP.success("Spectrogram settings saved."),t(e)},[t]);return(0,a.jsx)(C,{parameters:e,onParametersSave:n})}},94776:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var a=n(57437);function s(e){let{children:t,padding:n="p-8"}=e;return(0,a.jsx)("div",{className:"".concat(n," w-full"),children:(0,a.jsx)("div",{className:"flex flex-col justify-center items-center p-4 w-full text-center rounded-md border border-dashed border-stone-500 text-stone-500",children:t})})}},9981:function(e,t,n){"use strict";n.d(t,{Z:function(){return m}});var a=n(57437),s=n(56800),r=n.n(s),l=n(87138);let o="whitespace-nowrap rounded-lg bg-stone-50 p-2 text-center text-sm font-medium dark:bg-stone-800 focus:outline-none focus:ring-4 focus:ring-emerald-500/50",i="text-emerald-500",c="text-stone-700 hover:bg-stone-200 hover:text-stone-900 dark:text-stone-400 dark:hover:bg-stone-700 dark:hover:text-stone-300";function d(e){let{children:t,active:n=!1,className:s,...l}=e;return(0,a.jsx)("button",{...l,className:r()(o,n?i:c,s),children:t})}function u(e){let{children:t,active:n=!1,className:s,...d}=e;return(0,a.jsx)(l.default,{...d,className:r()(o,n?i:c,s,"p-2 inline-block"),children:t})}function m(e){let{tabs:t}=e;return(0,a.jsx)("ul",{className:"flex space-x-4",children:t.map(e=>(0,a.jsx)("li",{children:null!=e.href?(0,a.jsxs)(u,{href:e.href,active:e.isActive,children:[e.icon?(0,a.jsx)("span",{className:"mr-1 inline-block align-middle",children:e.icon}):null,e.title]}):(0,a.jsxs)(d,{onClick:e.onClick,active:e.isActive,children:[e.icon?(0,a.jsx)("span",{className:"mr-1 inline-block align-middle",children:e.icon}):null,e.title]})},e.id))})}},14396:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var a=n(57437),s=n(2265),r=n(23635),l=n(35103),o=n(14088),i=n(9981),c=n(33833);let d={};function u(e){let[t,n]=(0,s.useState)(e.tabs[0].id),r=(0,c.Z)({defaults:e.filter||d}),l=(0,s.useMemo)(()=>e.tabs.map(e=>({...e,isActive:e.id===t,onClick:()=>n(e.id)})),[e.tabs,t]);return(0,a.jsxs)("div",{className:"flex flex-col gap-2 p-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"flex flex-row justify-center",children:(0,a.jsx)("p",{className:"text-stone-500 text-sm max-w-prose text-center",children:e.description})}),(0,a.jsx)(m,{filter:r,filterDef:e.filterDef})]}),(0,a.jsx)("div",{className:"flex flex-row gap-2 justify-center w-full",children:(0,a.jsx)(i.Z,{tabs:l})}),(0,a.jsx)("div",{className:"p-4",children:e.children({view:t,filter:r.filter})})]})}function m(e){let{filter:t,filterDef:n}=e;return(0,a.jsxs)("div",{className:"flex flex-row items-center gap-2 px-2",children:[(0,a.jsx)(l.Z,{mode:"text",filter:t,filterDef:n,button:(0,a.jsxs)(a.Fragment,{children:["Add filters ",(0,a.jsx)(o.k1,{className:"inline-block w-4 h-4 stroke-2"})]})}),(0,a.jsx)(r.Z,{filter:t,filterDef:n,showIfEmpty:!0,withLabel:!1})]})}},63425:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var a=n(57437),s=n(12098),r=n(14088),l=n(93847),o=n(61317);let i=[1,5,10,25,50,100];function c(e){let{pageSize:t,setPageSize:n}=e;return(0,a.jsx)(o.Z,{label:"Page Size:",selected:{label:t.toString(),value:t,id:t},onChange:e=>n(e),options:i.map(e=>({label:e.toString(),value:e,id:e}))})}function d(e){let{page:t,numPages:n,nextPage:o,hasNextPage:i,hasPrevPage:d,prevPage:u,setPage:m,pageSize:f,setPageSize:x}=e;return(0,a.jsxs)("div",{className:"flex flex-row space-x-2",children:[(0,a.jsx)(s.Z,{disabled:0===t,onClick:()=>m(0),variant:"secondary",mode:"text",children:(0,a.jsx)(r.Op,{className:"h-5 w-5 fill-transparent stroke-inherit"})}),(0,a.jsx)(s.Z,{onClick:u,disabled:!d,variant:"secondary",mode:"text",children:(0,a.jsx)(r.jJ,{className:"h-5 w-5 fill-transparent stroke-inherit"})}),(0,a.jsx)("div",{className:"w-14",children:(0,a.jsx)(l.II,{disabled:1===n,type:"number",className:"remove-arrow",value:t+1,onChange:e=>m(parseInt(e.target.value)-1)})}),(0,a.jsxs)(s.Z,{disabled:!0,variant:"secondary",mode:"text",children:["/ ",n]}),(0,a.jsx)(s.Z,{onClick:o,disabled:!i,variant:"secondary",mode:"text",children:(0,a.jsx)(r.Ne,{className:"h-5 w-5 fill-transparent stroke-inherit"})}),(0,a.jsx)(s.Z,{disabled:t===n-1,onClick:()=>m(n-1),variant:"secondary",mode:"text",children:(0,a.jsx)(r.OZ,{className:"h-5 w-5 fill-transparent stroke-inherit"})}),(0,a.jsx)(c,{pageSize:f,setPageSize:x})]})}},35466:function(e,t,n){"use strict";n.d(t,{Z:function(){return j}});var a=n(57437),s=n(2265),r=n(82517),l=n(24729),o=n(58992),i=n(36305),c=n(25648),d=n(4791),u=n(87697),m=n(19551),f=n(26140),x=n(2803),v=n(7832),h=n(99258),p=n(46964),g=n(48422);function j(e){var t,n;let{recording:j,soundEventAnnotation:b,parameters:w=r._z,height:Z=384,withBar:k=!0,withPlayer:N=!0,withControls:y=!0,withSettings:C=!0,onParametersSave:S}=e,P=(0,s.useRef)(null),E=null!==(n=null===(t=P.current)||void 0===t?void 0:t.getBoundingClientRect())&&void 0!==n?n:{width:0,height:0},[A,_]=(0,s.useMemo)(()=>{let[e,t,n]=(0,v.fM)(b.sound_event.geometry);return[e,n]},[b.sound_event]),T=(0,s.useMemo)(()=>{let e=Math.max((_-A)*9,.2),t=(A+_)/2;return{time:{min:t-e/2,max:t+e/2},freq:{min:0,max:j.samplerate/2}}},[j.samplerate,A,_]),M=(0,s.useMemo)(()=>{let e=Math.min((_-A)*5,5),t=(A+_)/2;return(0,h.Fj)({startTime:t-e/2,endTime:t+e/2,samplerate:j.samplerate,parameters:w})},[j.samplerate,w,A,_]),D=(0,m.Z)({recording:j,endTime:T.time.max,startTime:T.time.min}),{seek:F}=D,z=(0,s.useCallback)(e=>{let{position:t}=e;F(t.time)},[F]),R=(0,u.Z)({dimensions:E,recording:j,bounds:T,initial:M,parameters:w,onDoubleClick:z,enabled:!D.isPlaying}),{centerOn:O}=R,I=(0,s.useCallback)(e=>O({time:e}),[O]),{draw:B,enabled:J}=(0,x.Z)({viewport:R.viewport,currentTime:D.currentTime,isPlaying:D.isPlaying,onTimeChange:I}),{props:q,draw:L,isLoading:G}=R,K=(0,p.Z)({viewport:R.viewport,annotations:[b]}),Q=(0,g.Z)({annotations:[b],viewport:R.viewport,dimensions:E,disabled:!0}),U=(0,s.useMemo)(()=>G?e=>{e.canvas.style.cursor="wait"}:J?e=>{L(e),B(e),K(e)}:e=>{L(e),K(e)},[L,B,G,J,K]);return(0,f.Z)({ref:P,draw:U}),(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsxs)("div",{className:"flex flex-row gap-4",children:[y&&(0,a.jsx)(i.Z,{canDrag:R.canDrag,canZoom:R.canZoom,onReset:R.reset,onDrag:R.enableDrag,onZoom:R.enableZoom}),C&&(0,a.jsx)(c.Z,{samplerate:j.samplerate,settings:R.parameters,onChange:R.setParameters,onReset:R.resetParameters,onSave:()=>null==S?void 0:S(R.parameters)}),N&&(0,a.jsx)(l.Z,{...D})]}),(0,a.jsx)("div",{className:"relative rounded-md",style:{height:Z},children:(0,a.jsx)(d.ZP,{tags:Q,disabled:!0,children:(0,a.jsx)("canvas",{ref:P,...q,className:"absolute w-full h-full"})})}),k&&(0,a.jsx)(o.Z,{bounds:R.bounds,viewport:R.viewport,onMove:R.zoom})]})}},4791:function(e,t,n){"use strict";n.d(t,{ZP:function(){return h}});var a=n(57437),s=n(49896),r=n(35933),l=n(56800),o=n.n(l),i=n(2265),c=n(14088),d=n(48423),u=n(75728);function m(e){let{onClose:t,onAdd:n,onCreate:s,filter:r,...l}=e;return(0,a.jsx)(d.Z,{onSelect:e=>{null==n||n(e)},onCreate:s,autoFocus:!0,onKeyDown:e=>{"Escape"===e.key?null==t||t():"Enter"===e.key&&(null==t||t())},initialFilter:r,...l})}function f(e){let{tag:t,onClick:n,disabled:s=!1}=e,r=(0,u.Z)(e=>e.getTagColor)(t),l=(0,i.useMemo)(()=>"bg-".concat(r.color,"-500"),[r]);return(0,a.jsxs)("span",{className:"flex flex-row gap-1 -my-2 items-center px-2 rounded-full transition-all group bg-stone-200/0 dark:bg-stone-800/0 hover:bg-stone-200 hover:dark:bg-stone-800",children:[(0,a.jsx)("span",{className:"inline-block my-2 w-2 h-2 rounded-full ".concat(l," ring-1 ring-stone-900 opacity-100")}),(0,a.jsxs)("button",{type:"button",className:"hidden flex-row gap-1 items-center opacity-0 transition-all group-hover:flex group-hover:opacity-100 hover:text-red-500 text-stone-800 dark:text-stone-400",onClick:n,children:[(0,a.jsx)("span",{className:"hidden text-xs font-thin whitespace-nowrap opacity-0 transition-all group-hover:inline-block group-hover:opacity-100",children:t.key}),(0,a.jsx)("span",{className:"hidden text-sm font-medium whitespace-nowrap opacity-0 transition-all group-hover:inline-block group-hover:opacity-100",children:t.value}),!s&&(0,a.jsx)(c.Tw,{className:"inline-block w-3 h-3 stroke-2"})]})]})}function x(e){let{filter:t,onCreate:n,onAdd:l}=e;return(0,a.jsx)(s.J,{as:"div",children:(0,a.jsxs)(r.bv,{placement:"bottom",offset:4,zIndex:20,enter:"transition duration-200 ease-out",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition duration-150 ease-in",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",portal:!0,children:[(0,a.jsxs)(s.J.Button,{className:"rounded hover:text-emerald-500 focus:ring-4 focus:outline-none group focus:ring-emerald-500/50 z-20",children:["+",(0,a.jsx)(c.lO,{className:"inline-block ml-1 w-4 h-4 stroke-2"}),(0,a.jsx)("span",{className:"hidden absolute ml-1 whitespace-nowrap opacity-0 transition-all duration-200 group-hover:inline-block group-hover:opacity-100",children:"Add tag"})]}),(0,a.jsx)(s.J.Panel,{className:"w-52",focus:!0,unmount:!0,children:e=>{let{close:s}=e;return(0,a.jsx)(m,{filter:t,onClose:s,onCreate:e=>{null==n||n(e),s()},onAdd:e=>{null==l||l(e),s()}})}})]})})}function v(e){let{group:t,filter:n,onCreate:s,disabled:r=!1}=e,{x:l,y:i}=t.position;return(0,a.jsxs)("div",{className:o()({"pointer-events-none":!t.active},"h-5 flex flex-col absolute px-2 text-stone-300 hover:z-50 z-40"),style:{left:l,top:i},children:[(0,a.jsx)("div",{className:"-ms-2 relative flex flex-col right-0 hover:gap-2",children:t.tags.map(e=>(0,a.jsx)(f,{...e,disabled:r},"".concat(e.tag.key,":").concat(e.tag.value)))}),!r&&(0,a.jsx)(x,{filter:n,onCreate:e=>{var n;null==s||s(e),null===(n=t.onAdd)||void 0===n||n.call(t,e)},onAdd:e=>{var n;null===(n=t.onAdd)||void 0===n||n.call(t,e)}})]})}function h(e){let{tags:t,children:n,filter:s,onCreate:r,disabled:l=!1}=e;return(0,a.jsxs)("div",{className:"relative w-full h-full rounded",children:[n,t.map(e=>(0,a.jsx)(v,{group:e,filter:s,onCreate:r,disabled:l},e.annotation.uuid))]})}},46964:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var a=n(2265),s=n(74257),r=n(79105),l=n(7832);let o={borderColor:r.Ej,fillColor:r.Ej,borderWidth:2,fillAlpha:.1};function i(e){let{viewport:t,annotations:n}=e;return(0,a.useCallback)(e=>{for(let a of n){let n=(0,l.w9)({width:e.canvas.width,height:e.canvas.height},a.sound_event.geometry,t);(0,s.Z)(e,n,o)}},[t,n])}},40127:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var a=n(2265),s=n(37051),r=n(26731);function l(e){let{uuid:t,soundEventAnnotation:n,clipAnnotation:l,onDelete:o,onUpdate:i,onAddTag:c,onRemoveTag:d,onAddNote:u,onError:m,enabled:f=!0,withRecording:x=!1}=e,{query:v,useQuery:h,useMutation:p,useDestruction:g,client:j}=(0,r.ZP)({name:"sound_event_annotation",uuid:t,initial:n,enabled:f,getFn:s.Z.soundEventAnnotations.get,onError:m}),b=h({name:"annotations",queryFn:(0,a.useMemo)(()=>x?()=>{if(null==v.data)throw Error("Cannot get recording for sound event annotation without recording");return s.Z.soundEvents.getRecording(v.data.sound_event)}:()=>{throw Error("Cannot get recording for sound event annotation without recording")},[v.data,x]),enabled:x&&null!=v.data}),w=(0,a.useCallback)(e=>{null!=l&&j.setQueryData(["clip_annotation",l.uuid],t=>{var n;if(null!=t)return{...t,sound_events:null===(n=t.sound_events)||void 0===n?void 0:n.map(t=>t.uuid===e.uuid?e:t)}})},[j,l]),Z=(0,a.useCallback)(e=>{null==i||i(e),w(e)},[i,w]),k=p({mutationFn:s.Z.soundEventAnnotations.update,onSuccess:Z}),N=(0,a.useCallback)(e=>{null==o||o(e),w(e)},[o,w]),y=g({mutationFn:s.Z.soundEventAnnotations.delete,onSuccess:N}),C=(0,a.useCallback)(e=>{null==c||c(e),w(e)},[c,w]),S=p({mutationFn:s.Z.soundEventAnnotations.addTag,onSuccess:C}),P=(0,a.useCallback)(e=>{null==d||d(e),w(e)},[d,w]),E=p({mutationFn:s.Z.soundEventAnnotations.removeTag,onSuccess:P}),A=(0,a.useCallback)(e=>{null==u||u(e),w(e)},[u,w]),_=p({mutationFn:s.Z.soundEventAnnotations.addNote,onSuccess:A});return{...v,update:k,delete:y,addTag:S,removeTag:E,addNote:_,recording:b}}},48422:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var a=n(2265),s=n(7832),r=n(56943);function l(e){let{annotations:t,viewport:n,dimensions:l,onClickTag:o,onAddTag:i,active:c=!0,disabled:d=!1}=e,u=(0,a.useMemo)(()=>t.filter(e=>(0,s.PT)(e.sound_event.geometry,n)),[t,n]);return(0,a.useMemo)(()=>u.map(e=>{var t;let a=(0,r.D)(e,n,l);return{tags:(null===(t=e.tags)||void 0===t?void 0:t.map(t=>({tag:t,onClick:()=>null==o?void 0:o(e,t)})))||[],onAdd:t=>null==i?void 0:i(e,t),position:a,annotation:e,active:c,disabled:d}}),[u,n,l,c,o,i,d])}}},function(e){e.O(0,[8173,8083,5790,3277,231,932,9226,4898,3215,8726,6845,4880,8026,595,6151,7771,873,7051,3847,2302,1780,1479,3511,2971,7023,1744],function(){return e(e.s=59396)}),_N_E=e.O()}]);