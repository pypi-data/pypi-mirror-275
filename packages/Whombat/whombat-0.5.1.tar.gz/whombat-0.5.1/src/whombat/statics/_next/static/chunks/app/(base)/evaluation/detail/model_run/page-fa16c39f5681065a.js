(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6578],{69697:function(e,t,n){Promise.resolve().then(n.bind(n,53528))},16463:function(e,t,n){"use strict";var l=n(71169);n.o(l,"notFound")&&n.d(t,{notFound:function(){return l.notFound}}),n.o(l,"usePathname")&&n.d(t,{usePathname:function(){return l.usePathname}}),n.o(l,"useRouter")&&n.d(t,{useRouter:function(){return l.useRouter}}),n.o(l,"useSearchParams")&&n.d(t,{useSearchParams:function(){return l.useSearchParams}}),n.o(l,"useSelectedLayoutSegment")&&n.d(t,{useSelectedLayoutSegment:function(){return l.useSelectedLayoutSegment}})},85391:function(e,t,n){"use strict";let l=(0,n(2265).createContext)({name:"",description:"",tags:[],uuid:"",created_on:new Date,task:"sound_event_detection"});t.Z=l},53528:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return eZ}});var l=n(57437),s=n(16463),a=n(2265),i=n(88726),o=n(2857),r=n(56648),c=n(71672),d=n(55429),u=n(93847),x=n(75761),m=n(12098),h=n(14088);function v(e){let{onDelete:t}=e;return(0,l.jsx)(x.Z,{title:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(h.aN,{className:"inline-block w-8 h-8 mr-2 text-red-500"}),"Are you sure you want to delete this model run?"]}),button:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(h.pJ,{className:"inline-block w-5 h-5 mr-2"}),"Delete"]}),mode:"text",variant:"danger",children:e=>{let{close:n}=e;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,l.jsx)("p",{children:"This action cannot be undone. This will permanently delete the model run with all its predictions and evaluations."}),(0,l.jsx)("p",{children:"Do you want to proceed?"})]}),(0,l.jsxs)("div",{className:"flex flex-row justify-end gap-2 mt-4",children:[(0,l.jsxs)(m.Z,{tabIndex:0,mode:"text",variant:"danger",onClick:t,children:[(0,l.jsx)(h.pJ,{className:"h-5 w-5 inline-block mr-2"}),"Delete"]}),(0,l.jsxs)(m.Z,{tabIndex:1,mode:"outline",variant:"primary",onClick:n,children:[(0,l.jsx)(h.Tw,{className:"h-5 w-5 inline-block mr-2"}),"Cancel"]})]})]})}})}var f=n(37051),p=n(26731);function j(e){let{uuid:t,modelRun:n,enabled:l=!0,onUpdate:s,onDelete:a,onEvaluate:i,onError:o}=e;if(void 0!==n&&n.uuid!==t)throw Error("Model Run uuid does not match");let{query:r,useMutation:c,useDestruction:d}=(0,p.ZP)({uuid:t,initial:n,name:"model_run",enabled:l,getFn:f.Z.modelRuns.get,onError:o}),u=c({mutationFn:f.Z.modelRuns.update,onSuccess:s}),x=c({mutationFn:f.Z.modelRuns.evaluate,onSuccess:i,withUpdate:!1}),m=d({mutationFn:f.Z.modelRuns.delete,onSuccess:a});return{...r,update:u,delete:m,evaluate:x}}function g(e){let{onDelete:t,onUpdate:n}=e,{data:s,delete:{mutateAsync:i},update:{mutateAsync:o}}=j({uuid:e.modelRun.uuid,modelRun:e.modelRun}),r=(0,a.useCallback)(()=>{let e=i();null==t||t(e)},[i,t]),x=(0,a.useCallback)(e=>{let t=o(e);null==n||n(t)},[o,n]);return(0,l.jsxs)("div",{className:"flex flex-col",children:[(0,l.jsx)("div",{className:"flex flex-row gap-2 justify-center",children:(0,l.jsx)(v,{onDelete:r})}),(0,l.jsxs)(c.Z,{children:[(0,l.jsxs)("div",{className:"px-4 sm:px-0",children:[(0,l.jsx)("h3",{className:"text-base font-semibold leading-7 text-stone-900 dark:text-stone-200",children:null==s?void 0:s.name}),(0,l.jsx)("p",{className:"text-stone-500 text-xs",children:null==s?void 0:s.version})]}),(0,l.jsx)("div",{className:"mt-6 border-t border-stone-300 dark:border-stone-700",children:(0,l.jsxs)("dl",{className:"divide-y divide-stone-500",children:[(0,l.jsxs)("div",{className:"py-6 px-4 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-0",children:[(0,l.jsx)(d.iV,{children:"Description"}),(0,l.jsx)(d.ue,{value:null==s?void 0:s.description,onChange:e=>x({description:e}),Input:u.Kx,autoFocus:!0,children:null==s?void 0:s.description})]}),(0,l.jsxs)("div",{className:"py-6 px-4 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-0",children:[(0,l.jsx)(d.iV,{children:"Imported On"}),(0,l.jsx)(d.pj,{children:null==s?void 0:s.created_on.toLocaleString()})]})]})})]})]})}var N=n(25524),w=n(33833),b=n(30635);let k={},Z=[];var y=n(68e3),C=n(94776),_=n(65449);function S(e){var t;return(0,l.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,l.jsxs)("div",{className:"flex flex-row justify-between items-center gap-8",children:[(0,l.jsx)(_.Z,{icon:(0,l.jsx)(h.Vr,{className:"h-5 w-5 inline-block text-stone-500 mr-1 align-middle"}),title:"Overall Score",value:(100*e.evaluation.score).toFixed(2)}),(0,l.jsxs)("div",{className:"flex grow flex-col gap-2 items-end",children:[(0,l.jsx)("span",{className:"text-md font-bold text-stone-500",children:"Metrics"}),(0,l.jsx)("div",{className:"flex flex-row flex-wrap gap-8",children:null===(t=e.evaluation.metrics)||void 0===t?void 0:t.map(e=>(0,l.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,l.jsx)("span",{className:"text-sm text-stone-500",children:e.name}),(0,l.jsx)("span",{className:"text-lg",children:(100*e.value).toFixed(2)})]},e.name))})]})]}),(0,l.jsx)("div",{className:"flex flex-row justify-end",children:(0,l.jsxs)("span",{className:"text-sm text-stone-500 ",children:["Evaluated on ",e.evaluation.created_on.toLocaleString()]})})]})}var P=n(23635),T=n(35103),M=n(87749),E=n(64454),F=n(98701),R=n(76706);let D=[{field:"prediction_tag",name:"Predicted Tag",render:e=>{let{value:t,clear:n}=e;return(0,l.jsx)(F.Z,{field:"Predicted Tag",value:"".concat(t.tag.key,": ").concat(t.tag.value),onRemove:n})},selector:e=>{let{setFilter:t}=e;return(0,l.jsx)(R.D3,{onChange:e=>t("prediction_tag",{tag:e})})},description:"Select clips with a specific predicted tag.",icon:(0,l.jsx)(h.lO,{className:"h-5 w-5 inline-block text-stone-500 mr-1 align-middle"})},{field:"annotation_tag",name:"True Tag",render:e=>{let{value:t,clear:n}=e;return(0,l.jsx)(F.Z,{field:"True Tag",value:"".concat(t.key,": ").concat(t.value),onRemove:n})},selector:e=>{let{setFilter:t}=e;return(0,l.jsx)(R.D3,{onChange:e=>t("annotation_tag",e)})},description:"Select clips with a specific true tag.",icon:(0,l.jsx)(h.lO,{className:"h-5 w-5 inline-block text-stone-500 mr-1 align-middle"})},{field:"score",name:"Score",selector:e=>{let{setFilter:t}=e;return(0,l.jsx)(R.P9,{name:"duration",onChange:e=>t("score",e)})},render:e=>{let{value:t,clear:n}=e;return(0,l.jsx)(F.V,{field:"Score",value:t,onRemove:n})},icon:(0,l.jsx)(h.Vr,{className:"h-5 w-5 inline-block text-stone-500 mr-1 align-middle"})}],A={},V=[],z={min:.5,max:1};var L=n(82517),O=n(24729),H=n(58992),I=n(36305),U=n(25648),q=n(56800),B=n.n(q),J=n(75728),K=n(6922);function W(e){let{tags:t,children:n,threshold:s}=e;return(0,l.jsxs)("div",{className:"overflow-hidden relative w-full h-full rounded",children:[n,t.map(e=>(0,l.jsx)(Q,{group:e,threshold:s},e.annotation.uuid))]})}let X="inline-block my-2 w-2 h-2 rounded-full opacity-100",Y="hidden text-xs font-thin whitespace-nowrap opacity-0 transition-all group-hover:inline-block group-hover:opacity-100";function G(e){let{tag:t,onClick:n,score:s=1}=e,i=(0,J.Z)(e=>e.getTagColor)(t),o=(0,a.useMemo)(()=>(0,K.wX)(i.color,i.level),[i]),r=(0,a.useMemo)(()=>(function(e){let t=Math.round(8*Math.min(Math.max(e,0),1))+1;return{background:"bg-emerald-".concat(t,"00 dark:bg-emerald-").concat(10-t,"00"),text:"text-emerald-".concat(t,"00 dark:text-emerald-").concat(10-t,"00")}})(s),[s]);return(0,l.jsxs)("span",{className:"flex flex-row gap-1 -my-2 items-center px-2 rounded-full transition-all group bg-stone-200/0 dark:bg-stone-800/0 hover:bg-stone-200 hover:dark:bg-stone-800",children:[(0,l.jsx)("span",{className:B()(X,o.background)}),(0,l.jsx)("span",{className:B()(X,r.background)}),(0,l.jsxs)("button",{type:"button",className:"hidden flex-row gap-1 items-center opacity-0 transition-all group-hover:flex group-hover:opacity-100 text-stone-800 dark:text-stone-400",onClick:n,children:[(0,l.jsxs)("span",{className:B()(Y,r.text),children:[Math.round(100*s),"%"]}),(0,l.jsx)("span",{className:Y,children:t.key}),(0,l.jsx)("span",{className:B()(Y,"group-hover:underline"),children:t.value})]})]})}function Q(e){let{group:t,threshold:n}=e,{x:s,y:a}=t.position;return(0,l.jsx)("div",{className:B()({"pointer-events-none":!t.active},"h-5 flex flex-col absolute px-2 text-stone-300 hover:z-50 z-40"),style:{left:s,top:a},children:(0,l.jsx)("div",{className:"-ms-2 relative flex flex-col right-0 hover:gap-2",children:t.tags.filter(e=>{var t,l;let{score:s=1}=e;return s>=(null!==(t=null==n?void 0:n.min)&&void 0!==t?t:0)&&s<=(null!==(l=null==n?void 0:n.max)&&void 0!==l?l:1)}).sort((e,t)=>(t.score||1)-(e.score||1)).map(e=>(0,l.jsx)(G,{...e},"".concat(e.tag.key,":").concat(e.tag.value)))})})}var $=n(87697),ee=n(19551),et=n(26140),en=n(2803),el=n(99258),es=n(74257),ea=n(79105),ei=n(7832);let eo={min:.5,max:1};var er=n(56943);let ec={min:.5,max:1},ed={min:.5,max:1};function eu(e){var t,n;let{clipEvaluation:s,threshold:i=ed,parameters:o=L._z,showPredictions:r=!0,showAnnotations:d=!0,onParameterSave:u}=e,x=(0,a.useRef)(null),m=null!==(n=null===(t=x.current)||void 0===t?void 0:t.getBoundingClientRect())&&void 0!==n?n:{width:0,height:0},{clip_prediction:h}=s,{clip:v}=h,{recording:f}=v,p=(0,a.useMemo)(()=>({time:{min:v.start_time,max:v.end_time},freq:{min:0,max:f.samplerate/2}}),[v.start_time,v.end_time,f.samplerate]),j=(0,a.useMemo)(()=>(0,el.AX)({startTime:v.start_time,endTime:v.end_time,samplerate:f.samplerate,parameters:o}),[f.samplerate,v.start_time,v.end_time,o]),g=(0,ee.Z)({recording:f,endTime:p.time.max,startTime:p.time.min}),{seek:N}=g,w=(0,a.useCallback)(e=>{let{position:t}=e;N(t.time)},[N]),b=(0,$.Z)({dimensions:m,recording:f,bounds:p,initial:j,parameters:o,onDoubleClick:w,enabled:!g.isPlaying}),{centerOn:k}=b,Z=(0,a.useCallback)(e=>k({time:e}),[k]),{draw:y,enabled:C}=(0,en.Z)({viewport:b.viewport,currentTime:g.currentTime,isPlaying:g.isPlaying,onTimeChange:Z}),{props:_,draw:S,isLoading:P}=b,T=(0,a.useMemo)(()=>h.sound_events||[],[h.sound_events]),M=(0,a.useMemo)(()=>s.sound_event_evaluations||[],[s.sound_event_evaluations]),E=function(e){let{viewport:t,matches:n,threshold:l=eo,showAnnotations:s=!0,showPredictions:i=!0}=e;return(0,a.useCallback)(e=>{let a={width:e.canvas.width,height:e.canvas.height};for(let o of n){let{source:n,target:r}=o;if(null!=n&&(n.score<l.min||n.score>l.max)&&(n=null),null==r&&null==n)continue;let c=null;null!=r&&s&&(c=(0,ei.w9)(a,r.sound_event.geometry,t));let d=null;null!=n&&i&&(d=(0,ei.w9)(a,n.sound_event.geometry,t)),null!=c&&(0,es.Z)(e,c,{borderColor:null!=d?ea.ZA:ea.ud,fillColor:null!=d?ea.ZA:ea.ud,borderWidth:2,fillAlpha:.1}),null!=d&&(0,es.Z)(e,d,{borderColor:null!=c?ea.ZA:ea.hM,fillColor:null!=c?ea.ZA:ea.hM,borderWidth:2,fillAlpha:.1,borderDash:[5,5]})}},[n,s,i,l,t])}({viewport:b.viewport,matches:M,threshold:i,showPredictions:r,showAnnotations:d}),F=function(e){let{predictions:t,viewport:n,dimensions:l,threshold:s=ec,onClickTag:i,active:o=!0}=e,r=(0,a.useMemo)(()=>t.filter(e=>!(e.score<s.min)&&!(e.score>s.max)&&(0,ei.PT)(e.sound_event.geometry,n)),[t,n,s]);return(0,a.useMemo)(()=>r.map(e=>{var t;let s=(0,er.D)(e,n,l);return{tags:(null===(t=e.tags)||void 0===t?void 0:t.map(t=>({score:t.score,tag:t.tag,onClick:()=>null==i?void 0:i(e,t)})))||[],position:s,annotation:e,active:o}}),[r,n,l,o,i])}({predictions:T,viewport:b.viewport,dimensions:m,threshold:i}),R=(0,a.useMemo)(()=>P?e=>{e.canvas.style.cursor="wait"}:C?e=>{S(e),y(e),E(e)}:e=>{S(e),E(e)},[S,y,P,C,E]);return(0,et.Z)({ref:x,draw:R}),(0,l.jsx)("div",{children:(0,l.jsxs)(c.Z,{children:[(0,l.jsxs)("div",{className:"flex flex-row gap-4",children:[(0,l.jsx)(I.Z,{canDrag:b.canDrag,canZoom:b.canZoom,onReset:b.reset,onDrag:b.enableDrag,onZoom:b.enableZoom}),(0,l.jsx)(U.Z,{samplerate:f.samplerate,settings:b.parameters,onChange:b.setParameters,onReset:b.resetParameters,onSave:()=>null==u?void 0:u(b.parameters)}),(0,l.jsx)(O.Z,{...g})]}),(0,l.jsx)("div",{className:"relative overflow-hidden h-96 rounded-md",children:(0,l.jsx)(W,{tags:F,threshold:i,children:(0,l.jsx)("canvas",{ref:x,..._,className:"absolute w-full h-full"})})}),(0,l.jsx)(H.Z,{bounds:b.bounds,viewport:b.viewport,onMove:b.zoom})]})})}let ex={min:.5,max:1};function em(e){let t=(0,J.Z)(e=>e.getTagColor),{clipEvaluation:n,onTagClick:s,threshold:i=ex}=e,{clip_prediction:o,clip_annotation:r}=n,c=(0,a.useMemo)(()=>(o.tags||[]).filter(e=>e.score>=i.min&&e.score<=i.max),[o.tags,i]),d=(0,a.useMemo)(()=>r.tags||[],[r.tags]);return(0,l.jsxs)("div",{className:"p-2",children:[(0,l.jsxs)(y.H4,{className:"text-center",children:[(0,l.jsx)(h.Dg,{className:"inline-block w-4 h-4 mr-1"}),"Tags"]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4 mt-4",children:[(0,l.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,l.jsx)("h5",{className:"font-bold text-stone-500",children:"Predicted"}),c.map(e=>{let{tag:n}=e;return(0,l.jsx)(K.ZP,{tag:n,onClick:()=>null==s?void 0:s(n),...t(n)},"".concat(n.key,"-").concat(n.value))}),0===c.length&&(0,l.jsx)(C.Z,{padding:"p-0",children:"No predicted tags."})]}),(0,l.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,l.jsx)("h5",{className:"font-bold text-stone-500",children:"True"}),d.map(e=>(0,l.jsx)(K.ZP,{tag:e,onClick:()=>null==s?void 0:s(e),...t(e)},"".concat(e.key,"-").concat(e.value))),0===c.length&&(0,l.jsx)(C.Z,{padding:"p-0",children:"No tags."})]})]})]})}function eh(e){var t,n;let{clipEvaluation:s,threshold:a}=e;return(0,l.jsxs)("div",{className:"grid grid-cols-4",children:[(0,l.jsx)("div",{className:"col-span-3",children:(0,l.jsx)(eu,{clipEvaluation:s,threshold:a,showAnnotations:e.showAnnotations,showPredictions:e.showPredictions})}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex flex-row gap-4 p-4",children:[(0,l.jsxs)("div",{className:"flex flex-col",children:[(0,l.jsx)("span",{className:"text-md font-bold text-stone-500",children:"Clip Score"}),(0,l.jsx)("span",{className:"text-lg",children:(100*s.score).toFixed(2)})]}),(0,l.jsxs)("div",{className:"flex flex-col",children:[(0,l.jsx)("span",{className:"text-md font-bold text-stone-500",children:"Metrics"}),(0,l.jsxs)("span",{className:"inline-flex flex-wrap",children:[null===(t=s.metrics)||void 0===t?void 0:t.map(e=>(0,l.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,l.jsx)("span",{className:"text-sm text-stone-500",children:e.name}),(0,l.jsx)("span",{className:"text-lg",children:(100*e.value).toFixed(2)})]},e.name)),(null===(n=s.metrics)||void 0===n?void 0:n.length)===0&&"-"]})]})]}),(0,l.jsx)(em,{clipEvaluation:s})]})]})}function ev(e){let t=function(e){var t,n;let[l,s]=(0,a.useState)(null==e.clipEvaluation?0:null),[i,o]=(0,a.useState)(null!==(t=e.threshold)&&void 0!==t?t:z),[r,c]=(0,a.useState)(!0),[d,u]=(0,a.useState)(!0),{items:x,total:m,filter:h,isLoading:v,isError:p,pagination:{setPage:j,pageSize:g,page:N}}=function(){let{filter:e=A,fixed:t=V,pageSize:n=10,enabled:l=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,w.Z)({defaults:e,fixed:t}),{query:a,pagination:i,items:o,total:r}=(0,b.Z)({name:"clip_evaluations",queryFn:f.Z.clipEvaluations.getMany,pageSize:n,filter:s.filter,enabled:l});return null!=a.error&&console.error(a.error),{...a,filter:s,pagination:i,items:o,total:r}}({pageSize:10,filter:e.filter,fixed:Object.keys(null!==(n=e.filter)&&void 0!==n?n:{})}),k=(0,a.useMemo)(()=>v||null==l?null:l+N*g,[v,l,N,g]),Z=(0,a.useMemo)(()=>null==k?m>0:k<m-1,[k,m]),y=(0,a.useMemo)(()=>null==k?m>0:k>0,[k,m]),C=(0,a.useCallback)(e=>{let t=Math.floor(e/g),n=e%g;j(t),s(n)},[g,j]),_=(0,a.useCallback)(()=>{if(Z){if(null==k)return C(0);C(k+1)}},[Z,k,C]),S=(0,a.useCallback)(()=>{if(y){if(null==k)return C(0);C(k-1)}},[y,k,C]),P=(0,a.useCallback)(()=>{0!==m&&C(Math.floor(Math.random()*m))},[m,C]);return{clipEvaluation:(0,a.useMemo)(()=>{var t,n;return null==l?null!==(t=e.clipEvaluation)&&void 0!==t?t:null:v?null:null!==(n=x[l])&&void 0!==n?n:null},[l,x,e.clipEvaluation,v]),filter:h,total:m,isLoading:v,isError:p,hasNext:Z,hasPrev:y,threshold:i,showAnnotations:r,showPredictions:d,index:null!=k?k:null,next:_,prev:S,random:P,toggleAnnotations:()=>c(e=>!e),togglePredictions:()=>u(e=>!e),setThreshold:o}}({filter:e.filter,clipEvaluation:e.clipEvaluation});return(0,l.jsxs)("div",{className:"flex flex-col gap-2 w-full",children:[(0,l.jsxs)("div",{className:"flex flex-row items-center gap-4",children:[(0,l.jsx)("h4",{className:"text-lg font-bold text-stone-500",children:"Clip Explorer"}),(0,l.jsx)("p",{className:"text-sm text-stone-500",children:"Explore each of the evaluated clip."})]}),(0,l.jsx)(ef,{total:t.total,hasNext:t.hasNext,hasPrev:t.hasPrev,filter:t.filter,random:t.random,next:t.next,prev:t.prev,index:t.index,threshold:t.threshold,onThresholdChange:t.setThreshold,showAnnotations:t.showAnnotations,showPredictions:t.showPredictions,onToggleAnnotations:t.toggleAnnotations,onTogglePredictions:t.togglePredictions}),t.isLoading?(0,l.jsx)(o.Z,{}):null==t.clipEvaluation?(0,l.jsx)(C.Z,{children:(0,l.jsx)("p",{children:"No clip predictions found"})}):(0,l.jsx)(eh,{clipEvaluation:t.clipEvaluation,threshold:t.threshold,showAnnotations:t.showAnnotations,showPredictions:t.showPredictions})]})}function ef(e){return(0,l.jsxs)("div",{className:"flex flex-col",children:[(0,l.jsxs)("div",{className:"flex flex-row items-center gap-2 justify-between",children:[(0,l.jsx)(ep,{index:e.index,total:e.total}),(0,l.jsx)(ej,{...e}),(0,l.jsx)(eg,{...e})]}),(0,l.jsx)("div",{className:"flex flex-row items-center gap-2",children:(0,l.jsx)(P.Z,{filter:e.filter,filterDef:D,showIfEmpty:!0})})]})}function ep(e){var t,n;return(0,l.jsxs)("div",{className:"inline-flex gap-2",children:[(0,l.jsxs)("p",{className:"text-sm text-blue-500 font-bold",children:["#",null!==(t=e.index)&&void 0!==t?t:0]}),(0,l.jsxs)("p",{className:"text-sm text-stone-500",children:[null!==(n=e.total)&&void 0!==n?n:0," clips"]})]})}function ej(e){var t,n,s,a;return(0,l.jsxs)("div",{className:"inline-flex items-center gap-2",children:[(0,l.jsx)(T.Z,{filter:e.filter,filterDef:D,mode:"text",button:(0,l.jsxs)(l.Fragment,{children:["Add filters ",(0,l.jsx)(h.k1,{className:"inline-block w-4 h-4 stroke-2"})]})}),(0,l.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,l.jsx)("span",{className:"inline-block text-sm text-stone-500",children:"Annotations:"}),(0,l.jsx)(E.Z,{label:"annotations",isSelected:e.showAnnotations,onChange:e.onToggleAnnotations})]}),(0,l.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,l.jsx)("span",{className:"inline-block text-sm text-stone-500",children:"Predictions:"}),(0,l.jsx)(E.Z,{label:"predictions",isSelected:e.showPredictions,onChange:e.onTogglePredictions})]}),(0,l.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,l.jsx)("span",{className:"inline-block text-sm text-stone-500",children:"Threshold:"}),(0,l.jsx)("div",{className:"w-40",children:(0,l.jsx)(M.Z,{label:"threshold",minValue:0,maxValue:1,step:.05,formatter:e=>e.toFixed(2),value:[null!==(s=null===(t=e.threshold)||void 0===t?void 0:t.min)&&void 0!==s?s:0,null!==(a=null===(n=e.threshold)||void 0===n?void 0:n.max)&&void 0!==a?a:1],onChange:t=>{var n;let[l,s]=t;null===(n=e.onThresholdChange)||void 0===n||n.call(e,{min:l,max:s})}})})]})]})}function eg(e){return(0,l.jsxs)("div",{className:"inline-flex gap-2",children:[(0,l.jsx)(m.Z,{mode:"text",onClick:e.prev,disabled:!e.hasPrev,children:(0,l.jsx)(h.jJ,{className:"w-6 h-6"})}),(0,l.jsx)(m.Z,{mode:"text",onClick:e.random,disabled:!e.hasPrev&&!e.hasNext,children:(0,l.jsx)(h.Dj,{className:"w-6 h-6"})}),(0,l.jsx)(m.Z,{mode:"text",onClick:e.next,disabled:!e.hasNext,children:(0,l.jsx)(h.Ne,{className:"w-6 h-6"})})]})}function eN(){return(0,l.jsx)(C.Z,{children:(0,l.jsxs)("p",{children:["This model run has not been evaluated yet! Evaluate this model run by clicking the",(0,l.jsx)("span",{className:"text-emerald-500",children:" Evaluate "}),"button above."]})})}function ew(e){let{items:t,isLoading:n}=function(){let{filter:e=k,fixed:t=Z,pageSize:n=10,enabled:l=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,w.Z)({defaults:e,fixed:t}),{query:a,pagination:i,items:o,total:r}=(0,b.Z)({name:"evaluations",queryFn:f.Z.evaluations.getMany,pageSize:n,filter:s.filter,enabled:l}),c=(0,N.D)({mutationFn:f.Z.evaluations.create,onSuccess:()=>{a.refetch()}});return{...a,filter:s,pagination:i,items:o,total:r,create:c}}({filter:(0,a.useMemo)(()=>({model_run:e.modelRun,evaluation_set:e.evaluationSet}),[e.modelRun,e.evaluationSet]),pageSize:1}),s=t[0],i=(0,a.useCallback)(()=>f.Z.modelRuns.evaluate(e.modelRun,e.evaluationSet),[e.modelRun,e.evaluationSet]),{mutateAsync:r}=(0,N.D)({mutationFn:i}),{onEvaluate:d}=e,u=(0,a.useCallback)(async()=>{let e=r();null==d||d(e)},[r,d]),x=(0,a.useMemo)(()=>({evaluation:s}),[s]);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(c.Z,{children:[(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(y.H4,{children:"Evaluation"}),(0,l.jsx)("span",{className:"text-stone-500 text-sm",children:"Here you can see the evaluation for this model predictions when compared against the evaluation set."})]}),(0,l.jsx)("div",{className:"flex items-center",children:n?(0,l.jsx)(m.Z,{disabled:!0,children:(0,l.jsx)(o.Z,{})}):null==s?(0,l.jsx)(m.Z,{mode:"text",onClick:u,children:"Evaluate"}):(0,l.jsx)(m.Z,{mode:"text",onClick:u,children:"Update"})})]}),(0,l.jsx)("div",{className:"mt-4",children:n?(0,l.jsx)(o.Z,{}):null==s?(0,l.jsx)(eN,{}):(0,l.jsx)(S,{evaluation:s})})]}),(0,l.jsx)(c.Z,{children:n?(0,l.jsx)(o.Z,{}):null==s?(0,l.jsx)(eN,{}):(0,l.jsx)(ev,{filter:x})})]})}function eb(e){return(0,l.jsx)(r.Z,{sideBar:(0,l.jsx)(g,{modelRun:e.modelRun,onUpdate:e.onUpdate,onDelete:e.onDelete}),children:(0,l.jsx)("div",{className:"flex flex-col gap-4",children:(0,l.jsx)(ew,{modelRun:e.modelRun,evaluationSet:e.evaluationSet,onEvaluate:e.onEvaluate})})})}var ek=n(85391);function eZ(){let e=(0,s.useRouter)(),t=(0,s.useSearchParams)(),n=t.get("model_run_uuid"),r=t.get("evaluation_set_uuid"),c=(0,a.useContext)(ek.Z),d=(0,a.useCallback)(()=>{null==r&&e.push("/evaluation/"),e.push("/evaluation/detail/model_runs/?evaluation_set_uuid=".concat(r))},[e,r]),u=(0,a.useCallback)(e=>{var t;(null===(t=e.response)||void 0===t?void 0:t.status)===404&&(i.ZP.error("Model run not found"),d())},[d]),x=(0,a.useCallback)(e=>{i.ZP.promise(e,{loading:"Deleting model run...",success:"Model run deleted",error:"Failed to delete model run"}),e.then(()=>{d()})},[d]),m=(0,a.useCallback)(e=>{i.ZP.promise(e,{loading:"Evaluating the model run. Please wait...",success:"Model run evaluated!",error:"Failed to evaluate the model run."})},[]),h=j({uuid:n||void 0,onError:u});return h.isLoading?(0,l.jsx)(o.Z,{}):h.isError||null==h.data?u(h.error):(0,l.jsx)(eb,{modelRun:h.data,onDelete:x,evaluationSet:c,onEvaluate:m})}},75761:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var l=n(57437),s=n(57605);function a(e){let{children:t,title:n,button:a="Open",...i}=e;return(0,l.jsx)(s.Z,{title:n,label:a,...i,children:t})}},55429:function(e,t,n){"use strict";n.d(t,{iV:function(){return c},pj:function(){return r},ue:function(){return d}});var l=n(57437),s=n(56800),a=n.n(s),i=n(2265),o=n(14088);function r(e){let{children:t,className:n,...s}=e;return(0,l.jsx)("dd",{className:a()("mt-1 text-sm leading-6 text-stone-700 dark:text-stone-400 sm:col-span-2 sm:mt-0",n),...s,children:t})}function c(e){let{children:t,className:n,...s}=e;return(0,l.jsx)("dt",{className:a()("text-sm font-medium leading-6 text-stone-900 dark:text-stone-300",n),...s,children:t})}function d(e){let{children:t,Input:n,value:s,onChange:a,...c}=e,[d,u]=(0,i.useState)(!1),[x,m]=(0,i.useState)(s);return d?(0,l.jsx)(r,{children:(0,l.jsx)(n,{value:x,onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(a(x),u(!1)),"Escape"===e.key&&(m(s),u(!1))},onBlur:()=>{m(s),u(!1)},onChange:e=>m(e.target.value),...c})}):(0,l.jsxs)(r,{className:"flex flex-row justify-between",children:[t,(0,l.jsx)("button",{onClick:()=>u(!0),className:"text-sm text-stone-500 underline ml-2",children:(0,l.jsx)(o.dY,{className:"w-5 h-5 inline-block text-blue-500"})})]})}},57605:function(e,t,n){"use strict";n.d(t,{Z:function(){return c},t:function(){return d}});var l=n(57437),s=n(59226),a=n(24880),i=n(2265),o=n(12098),r=n(14088);function c(e){let{title:t,children:n,label:s,open:a=!1,width:r="max-w-md",...c}=e,[u,x]=(0,i.useState)(a);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(o.Z,{type:"button",onClick:()=>x(!0),...c,children:s}),(0,l.jsx)(d,{title:(0,l.jsx)("div",{children:t}),isOpen:u,onClose:()=>x(!1),children:e=>{let{close:t}=e;return(0,l.jsx)("div",{className:r,children:n({close:t})})}})]})}function d(e){let{title:t,children:n,onClose:c,isOpen:d=!0}=e;return(0,l.jsx)(s.u,{appear:!0,show:d,as:i.Fragment,children:(0,l.jsxs)(a.V,{as:"div",className:"relative z-50",onClose:()=>null==c?void 0:c(),children:[(0,l.jsx)(s.u.Child,{as:i.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-25"})}),(0,l.jsx)("div",{className:"overflow-y-auto fixed inset-0",children:(0,l.jsx)("div",{className:"flex justify-center items-center p-4 min-h-full text-center",children:(0,l.jsx)(s.u.Child,{as:i.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,l.jsxs)(a.V.Panel,{className:"overflow-hidden p-6 w-full text-left align-middle rounded-2xl shadow-xl transition-all transform max-w-fit bg-stone-50 text-stone-700 z-[99999] dark:bg-stone-700 dark:text-stone-300",children:[(0,l.jsxs)(a.V.Title,{as:"div",className:"mb-4 flex flex-row justify-between items-center gap-4",children:[null!=t&&(0,l.jsx)("h3",{className:"text-lg font-medium leading-6 text-stone-900 dark:text-stone-100",children:t}),(0,l.jsx)(o.Z,{onClick:()=>null==c?void 0:c(),variant:"secondary",mode:"text",children:(0,l.jsx)(r.Tw,{className:"w-5 h-5"})})]}),(0,l.jsx)("div",{className:"mt-2",children:n({close:()=>null==c?void 0:c()})})]})})})})]})})}},94776:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var l=n(57437);function s(e){let{children:t,padding:n="p-8"}=e;return(0,l.jsx)("div",{className:"".concat(n," w-full"),children:(0,l.jsx)("div",{className:"flex flex-col justify-center items-center p-4 w-full text-center rounded-md border border-dashed border-stone-500 text-stone-500",children:t})})}},68e3:function(e,t,n){"use strict";n.d(t,{H1:function(){return i},H2:function(){return o},H3:function(){return r},H4:function(){return c}});var l=n(57437),s=n(56800),a=n.n(s);function i(e){let{children:t,className:n,...s}=e;return(0,l.jsx)("h1",{className:a()("text-2xl font-bold text-stone-800 dark:text-stone-300",n),...s,children:t})}function o(e){let{children:t,className:n,...s}=e;return(0,l.jsx)("h2",{className:a()("text-xl font-bold text-stone-800 dark:text-stone-300",n),...s,children:t})}function r(e){let{children:t,className:n,...s}=e;return(0,l.jsx)("h3",{className:a()("text-lg font-semibold leading-7 items-center text-stone-800 dark:text-stone-300",n),...s,children:t})}function c(e){let{children:t,className:n,...s}=e;return(0,l.jsx)("h4",{className:a()(n,"text-md font-semibold leading-6 text-stone-800 dark:text-stone-300"),...s,children:t})}},65449:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var l=n(57437),s=n(4933);function a(e){let{icon:t,title:n,value:a,isLoading:i=!1,onClick:o}=e;return(0,l.jsxs)("div",{className:"flex flex-row gap-2 items-start",children:[(0,l.jsx)("button",{className:"flex-none cursor-pointer",onClick:o,children:t}),(0,l.jsxs)("div",{className:"flex-grow-0",children:[(0,l.jsx)("div",{className:"inline-flex items-baseline gap-2",children:i?(0,l.jsx)(s.Z,{className:"h-5 w-5",variant:"primary"}):(0,l.jsx)("span",{className:"text-xl font-bold",children:a.toLocaleString()})}),(0,l.jsx)("div",{className:"text-sm font-thin",children:n})]})]})}},56648:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var l=n(57437);function s(e){let{children:t,sideBar:n}=e;return(0,l.jsxs)("div",{className:"flex flex-row flex-wrap gap-8 justify-between lg:flex-nowrap w-100",children:[(0,l.jsx)("div",{className:"grow",children:t}),(0,l.jsx)("div",{className:"flex flex-col flex-none gap-4 max-w-sm",children:(0,l.jsx)("div",{className:"sticky top-8",children:n})})]})}}},function(e){e.O(0,[8173,8083,5790,3277,932,9226,4898,3215,8726,6845,4880,8026,595,6151,7771,873,7051,3847,2302,1780,1479,3511,2971,7023,1744],function(){return e(e.s=69697)}),_N_E=e.O()}]);