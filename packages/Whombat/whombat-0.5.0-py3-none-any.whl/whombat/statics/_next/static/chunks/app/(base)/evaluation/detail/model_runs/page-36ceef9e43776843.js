(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2479],{88434:function(e,t,n){Promise.resolve().then(n.bind(n,85067))},85391:function(e,t,n){"use strict";let r=(0,n(2265).createContext)({name:"",description:"",tags:[],uuid:"",created_on:new Date,task:"sound_event_detection"});t.Z=r},85067:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return k}});var r=n(57437),a=n(16463),o=n(2265),s=n(88726),l=n(57605),u=n(94776),i=n(14088),c=n(16315),d=n(63425),m=n(38875),f=n(2857),h=n(71672),x=n(15964);function p(e){let{modelRun:t}=e,n=(0,a.useSearchParams)(),s=(0,o.useMemo)(()=>{let e=new URLSearchParams(n);e.set("model_run_uuid",t.uuid);let r=new URL("/evaluation/detail/model_run/",window.location.href);return r.search=e.toString(),r},[n,t.uuid]);return(0,r.jsxs)(h.Z,{className:"w-full",children:[(0,r.jsxs)("div",{className:"flex flex-row gap-4",children:[(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("span",{className:"text-stone-500 text-sm",children:"Model"}),(0,r.jsx)("span",{className:"font-thin",children:t.name})]}),(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("span",{className:"text-stone-500 text-sm",children:"Version"}),(0,r.jsx)("span",{className:"font-thin",children:t.version})]}),(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("span",{className:"text-stone-500 text-sm",children:"Description"}),(0,r.jsx)("span",{className:"font-thin",children:t.description})]}),(0,r.jsx)("div",{className:"flex flex-col h-full justify-center",children:(0,r.jsxs)(x.Z,{href:s,mode:"text",children:["View",(0,r.jsx)(i.A5,{className:"w-6 h-6 ms-2"})]})})]}),(0,r.jsx)("div",{className:"flex flex-row justify-end",children:(0,r.jsxs)("span",{className:"text-stone-500 text-xs",children:["created on ",t.created_on.toLocaleString()]})})]})}var j=n(25524),v=n(39343),y=n(37051),b=n(93847);function g(e){var t;let{onCreate:n}=e,{register:a,handleSubmit:s,setError:l,formState:{errors:u}}=(0,v.cI)({mode:"onChange"}),{mutateAsync:c}=(0,j.D)({mutationFn:y.Z.modelRuns.import,onError:e=>{var t;(null===(t=e.response)||void 0===t?void 0:t.status)===422&&e.response.data.detail.forEach(e=>{l(e.loc[1],{message:e.msg})})}}),d=(0,o.useCallback)(async e=>{let t=new FormData,r=e.model_run[0];t.append("model_run",r);let a=c(t);null==n||n(a)},[c,n]);return(0,r.jsxs)("form",{className:"flex flex-col gap-4",onSubmit:s(d),children:[(0,r.jsx)(b.BZ,{name:"model_run",label:"Select an Model Run file to import",help:"The file must be in AOEF format",error:null===(t=u.file)||void 0===t?void 0:t.message,children:(0,r.jsx)(b.II,{type:"file",...a("model_run"),required:!0})}),(0,r.jsxs)(b.k4,{children:[(0,r.jsx)(i.rG,{className:"inline-block h-6 w-6 align-middle mr-2"}),"Import"]})]})}var N=n(64326);function w(){return(0,r.jsxs)(u.Z,{children:[(0,r.jsx)(i.aN,{className:"w-8 h-8 text-stone-500"}),(0,r.jsx)("p",{children:"No model runs found."}),(0,r.jsxs)("p",{children:["To create a model run click on the"," ",(0,r.jsxs)("span",{className:"text-emerald-500",children:[(0,r.jsx)(i.dt,{className:"inline-block mr-1 ml-2 w-4 h-4"}),"Import"," "]})," ","button above."]})]})}function Z(e){let{filter:t,onCreate:n,openImport:a=!1}=e,{items:o,isLoading:s,filter:u,pagination:h}=(0,N.Z)({filter:t,fixed:Object.keys(t||{})});return(0,r.jsxs)("div",{className:"flex flex-col p-8 space-y-2 w-full",children:[(0,r.jsxs)("div",{className:"flex flex-row space-x-4",children:[(0,r.jsx)("div",{className:"flex-grow",children:(0,r.jsx)(c.Z,{label:"Search",placeholder:"Search dataset...",value:u.get("search"),onChange:e=>u.set("search",e),onSubmit:()=>u.submit(),icon:(0,r.jsx)(i.ZA,{})})}),(0,r.jsx)("div",{className:"h-full",children:(0,r.jsx)(l.Z,{mode:"text",title:"Import a Model Run",open:a,label:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.rG,{className:"inline-block w-4 h-4 align-middle"})," ","Import"]}),children:()=>(0,r.jsx)(g,{onCreate:n})})})]}),s?(0,r.jsx)(f.Z,{}):(0,r.jsxs)(r.Fragment,{children:[0===o.length&&(0,r.jsx)(w,{}),(0,r.jsx)(m.Z,{items:o.map(e=>(0,r.jsx)(p,{modelRun:e},e.uuid))}),h.numPages>1&&(0,r.jsx)(d.Z,{...h})]})]})}var S=n(15052);function E(e){let{evaluationSet:t,onCreate:n,openImport:a=!1}=e,{addModelRun:{mutateAsync:s}}=(0,S.Z)({uuid:t.uuid,evaluationSet:t}),l=(0,o.useMemo)(()=>({evaluation_set:t}),[t]),u=(0,o.useCallback)(e=>{e.then(e=>s(e)),null==n||n(e)},[s,n]);return(0,r.jsx)(Z,{filter:l,openImport:a,onCreate:u})}var _=n(85391);function k(){let e=(0,a.useRouter)(),t=(0,a.useSearchParams)(),n=(0,o.useContext)(_.Z),l="true"===t.get("import"),u=(0,o.useCallback)(t=>{s.ZP.promise(t,{loading:"Creating the model run. Please wait...",success:"Model run Created!",error:"Failed to create the model run.)"}),t.then(t=>{e.push("/evaluation/detail/model_run/?model_run_uuid=".concat(t.uuid,"&evaluation_set_uuid=").concat(n.uuid))})},[e,n.uuid]);return(0,r.jsx)(E,{evaluationSet:n,openImport:l,onCreate:u})}},71672:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(57437),a=n(56800),o=n.n(a);function s(e){let{children:t,className:n,...a}=e;return(0,r.jsx)("div",{className:o()("border flex flex-col gap-3 p-4 rounded-md border-stone-200 dark:border-stone-800 text-stone-700 dark:text-stone-300",n),...a,children:t})}},15964:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(57437),a=n(56800),o=n.n(a),s=n(87138),l=n(12098);function u(e){let{children:t,variant:n="primary",mode:a="filled",padding:u="p-2.5",className:i,...c}=e,d=(0,l.y)({variant:n,mode:a,padding:u});return(0,r.jsx)(s.default,{...c,className:o()(d,i),children:t})}},15052:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(2265),a=n(37051),o=n(26731);function s(e){let{uuid:t,evaluationSet:n,enabled:s=!0,onAddModelRun:l,onAddUserRun:u,onUpdate:i,onDelete:c,onAddTag:d,onRemoveTag:m,onAddTasks:f,onError:h}=e,{query:x,useMutation:p,useDestruction:j}=(0,o.ZP)({uuid:t,initial:n,name:"evaluation_set",enabled:s,getFn:a.Z.evaluationSets.get,onError:h}),v=p({mutationFn:a.Z.evaluationSets.update,onSuccess:i}),y=p({mutationFn:a.Z.evaluationSets.addTag,onSuccess:d}),b=p({mutationFn:a.Z.evaluationSets.removeTag,onSuccess:m}),g=p({mutationFn:a.Z.evaluationSets.addEvaluationTasks,onSuccess:f}),N=p({mutationFn:a.Z.evaluationSets.addModelRun,onSuccess:l}),w=p({mutationFn:a.Z.evaluationSets.addUserRun,onSuccess:u}),Z=j({mutationFn:a.Z.evaluationSets.delete,onSuccess:c}),S=(0,r.useMemo)(()=>x.data?a.Z.evaluationSets.getDownloadUrl(x.data):"",[x.data]);return{...x,update:v,addTag:y,removeTag:b,addEvaluationTasks:g,addModelRun:N,addUserRun:w,delete:Z,downloadUrl:S}}},64326:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(37051),a=n(33833),o=n(30635);let s={},l=[];function u(){let{filter:e=s,fixed:t=l,pageSize:n=10,enabled:u=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=(0,a.Z)({defaults:e,fixed:t}),{query:c,pagination:d,items:m,total:f}=(0,o.Z)({name:"model_runs",queryFn:r.Z.modelRuns.getMany,pageSize:n,filter:i.filter,enabled:u});return{...c,filter:i,pagination:d,items:m,total:f}}},26731:function(e,t,n){"use strict";n.d(t,{ZP:function(){return l}});var r=n(25524),a=n(40932),o=n(93191),s=n(2265);function l(e){let{uuid:t,initial:n,name:l,enabled:u=!0,getFn:i,onError:c}=e,d=(0,o.NL)(),m=(0,s.useCallback)(async()=>{if(null==t)throw Error("No uuid provided for object of type ".concat(l));return await i(t)},[t,l,i]),f=(0,a.a)({queryKey:[l,t],queryFn:m,retry:(e,t)=>{var n;if(null==t)return e<3;let r=null==t?void 0:null===(n=t.response)||void 0===n?void 0:n.status;return null==r?e<3:(!(r>=400)||!(r<500))&&e<3},initialData:n,staleTime:3e5,enabled:u&&null!=t}),h=(0,s.useCallback)(e=>{d.setQueryData([l,t],e)},[d,t,l]),{error:x,isError:p}=f;return(0,s.useEffect)(()=>{p&&(null==c||c(x))},[x,p,c]),{query:f,client:d,setData:h,useQuery:e=>{let{queryFn:n,name:r,enabled:o=!1}=e;return function(e){let{uuid:t,query:n,queryFn:r,name:o,secondaryName:l,enabled:u=!1}=e,{status:i,data:c}=n,d=(0,s.useCallback)(async()=>{if("pending"===i)throw Error("No data for object of type ".concat(o," (uuid=").concat(t,"). ")+"Either the query is not enabled or the query is still loading.");if("error"===i)throw Error("Error while loading object of type ".concat(o," (uuid=").concat(t,"), cannot mutate"));return await r(c)},[i,c,r,o,t]);return(0,a.a)({queryFn:d,queryKey:[o,t,l],enabled:"pending"!==i&&"error"!==i&&u})}({uuid:t,query:f,queryFn:n,secondaryName:r,name:l,enabled:o})},useMutation:e=>{let{mutationFn:n,onSuccess:a,onError:o,withUpdate:u=!0}=e;return function(e){let{uuid:t,query:n,client:a,mutationFn:o,name:l,onSuccess:u,onError:i,withUpdate:c=!0}=e,{status:d,data:m}=n,f=(0,s.useCallback)(async e=>{if(null==t)throw Error("No uuid provided for object of type ".concat(l));if("pending"===d)throw Error("No data for object of type ".concat(l," (uuid=").concat(t,"). ")+"Either the query is not enabled or the query is still loading.");if("error"===d)throw Error("Error while loading object of type ".concat(l," (uuid=").concat(t,"), cannot mutate"));return await o(m,e)},[d,m,o,l,t]);return(0,r.D)({mutationFn:f,onSuccess:e=>{c&&a.setQueryData([l,t],e),null==u||u(e)},onError:i})}({uuid:t,query:f,client:d,mutationFn:n,name:l,onSuccess:a,onError:o,withUpdate:u})},useDestruction:e=>{let{mutationFn:n,onSuccess:a,onError:o}=e;return function(e){let{uuid:t,query:n,client:a,mutationFn:o,name:l,onSuccess:u,onError:i}=e,{status:c,data:d}=n,m=(0,s.useCallback)(async()=>{if(null==t)throw Error("No uuid provided for object of type ".concat(l));if("pending"===c)throw Error("No data for object of type ".concat(l," (uuid=").concat(t,"). ")+"Either the query is not enabled or the query is still loading.");if("error"===c)throw Error("Error while loading object of type ".concat(l," (uuid=").concat(t,"), cannot mutate"));return await o(d)},[c,d,o,l,t]);return(0,r.D)({mutationFn:m,onSuccess:e=>{a.removeQueries({queryKey:[l,t]}),null==u||u(e)},onError:i})}({uuid:t,query:f,client:d,mutationFn:n,name:l,onSuccess:a,onError:o})}}}}},function(e){e.O(0,[8173,8083,5790,3277,231,932,9226,4898,3215,8726,6845,4880,7051,3847,3127,2971,7023,1744],function(){return e(e.s=88434)}),_N_E=e.O()}]);