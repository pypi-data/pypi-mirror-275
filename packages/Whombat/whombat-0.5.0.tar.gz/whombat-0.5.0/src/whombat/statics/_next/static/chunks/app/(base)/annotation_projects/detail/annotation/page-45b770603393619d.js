(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3440],{36459:function(e,t,n){Promise.resolve().then(n.bind(n,71822))},16463:function(e,t,n){"use strict";var s=n(71169);n.o(s,"notFound")&&n.d(t,{notFound:function(){return s.notFound}}),n.o(s,"usePathname")&&n.d(t,{usePathname:function(){return s.usePathname}}),n.o(s,"useRouter")&&n.d(t,{useRouter:function(){return s.useRouter}}),n.o(s,"useSearchParams")&&n.d(t,{useSearchParams:function(){return s.useSearchParams}}),n.o(s,"useSelectedLayoutSegment")&&n.d(t,{useSelectedLayoutSegment:function(){return s.useSelectedLayoutSegment}})},71822:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return eC}});var s=n(57437),a=n(16463),l=n(2265),r=n(25524),o=n(88726),i=n(19985),c=n(82517),d=n(12098),u=n(23635),x=n(35103),m=n(98701),f=n(76706),h=n(14088);let j=[{field:"pending",name:"Pending",render:e=>{let{value:t,clear:n}=e;return(0,s.jsx)(m.Z,{field:"Pending",value:t?"Yes":"No",onRemove:n})},selector:e=>{let{setFilter:t}=e;return(0,s.jsx)(f.vN,{onChange:e=>t("pending",e)})},description:"Select only tasks that are pending",icon:(0,s.jsx)(h.dY,{className:"h-5 w-5 inline-block text-stone-500 mr-1 align-middle"})},{field:"verified",name:"Verified",render:e=>{let{value:t,clear:n}=e;return(0,s.jsx)(m.Z,{field:"Verified",value:t?"Yes":"No",onRemove:n})},selector:e=>{let{setFilter:t}=e;return(0,s.jsx)(f.vN,{onChange:e=>t("verified",e)})},description:"Select tasks by their verified status",icon:(0,s.jsx)(h.SA,{className:"h-5 w-5 inline-block text-stone-500 mr-1 align-middle"})},{field:"rejected",name:"Needs Review",render:e=>{let{value:t,clear:n}=e;return(0,s.jsx)(m.Z,{field:"Needs Review",value:t?"Yes":"No",onRemove:n})},selector:e=>{let{setFilter:t}=e;return(0,s.jsx)(f.vN,{onChange:e=>t("rejected",e)})},description:"Select tasks by their review status",icon:(0,s.jsx)(h.wv,{className:"h-5 w-5 inline-block text-stone-500 mr-1 align-middle"})},{field:"dataset",name:"Dataset",render:e=>{let{value:t,clear:n}=e;return(0,s.jsx)(m.Z,{field:"Dataset",value:t.name,onRemove:n})},selector:e=>{let{setFilter:t}=e;return(0,s.jsx)(f.Z,{onChange:e=>t("dataset",e)})},description:"Select tasks that come from a specific dataset",icon:(0,s.jsx)(h.lQ,{className:"h-5 w-5 inline-block text-stone-500 mr-1 align-middle"})},{field:"recording_tag",name:"Recording Tag",render:e=>{let{value:t,clear:n}=e;return(0,s.jsx)(m.Z,{field:"Recording Tag",value:"".concat(t.key,": ").concat(t.value),onRemove:n})},selector:e=>{let{setFilter:t}=e;return(0,s.jsx)(f.D3,{onChange:e=>t("recording_tag",e)})},description:"Select task that come from a recording with a specific tag",icon:(0,s.jsx)(h.lO,{className:"h-5 w-5 inline-block text-stone-500 mr-1 align-middle"})}];var g=n(64454),v=n(75716),p=n(237),b=n(57605),N=n(55948),k=n(68561),Z=n(9025);function w(){let{shortcuts:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[t,n]=(0,l.useState)(!1);return(0,k.Z)((0,Z.Z)({key:"h"}),()=>n(e=>!e)),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d.Z,{mode:"text",variant:"info",type:"button",onClick:()=>n(!0),children:(0,s.jsx)(h.by,{className:"inline-block w-4 h-4 align-middle"})}),(0,s.jsx)(b.t,{title:"Keyboard Shortcuts",isOpen:t,onClose:()=>n(!1),children:()=>(0,s.jsxs)("table",{className:"border-collapse border border-stone-500 table-auto",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"p-1 border border-stone-500 text-center",children:"Key"}),(0,s.jsx)("th",{className:"p-1 border border-stone-500 text-center",children:"Action"}),(0,s.jsx)("th",{className:"p-1 border border-stone-500 text-center",children:"Description"})]})}),(0,s.jsxs)("tbody",{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"p-2 border border-stone-500 text-center",children:(0,s.jsx)(N.Z,{code:"h"})}),(0,s.jsx)("td",{className:"p-2 border border-stone-500 text-center font-bold",children:"Help"}),(0,s.jsx)("td",{className:"p-2 border border-stone-500 text-left",children:"Show this help."})]}),null==e?void 0:e.map(e=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"p-2 border border-stone-500 text-center",children:(0,s.jsx)(N.Z,{code:e.shortcut.trim()||"Space"})}),(0,s.jsx)("td",{className:"p-2 border border-stone-500 text-center font-bold",children:e.label}),(0,s.jsx)("td",{className:"p-2 border border-stone-500 text-left",children:e.description})]},e.shortcut))]})]})})]})}var y=n(21165),C=n(12554),T=n(17624),S=n(38243);let F=[...C.c,...T.a,...S.Y];function A(e){var t;let{current:n,instructions:a,tasks:r,filter:o,onNext:i,onPrevious:c}=e,{missing:m,completed:f,verified:k,needReview:Z,total:C}=(0,l.useMemo)(()=>(0,y.q)(r),[r]);return(0,s.jsxs)("div",{className:"inline-flex gap-1 items-center h-full w-full",children:[(0,s.jsx)(p.Z,{tooltip:(0,s.jsxs)("div",{className:"inline-flex gap-2 items-center",children:["Previous Task",(0,s.jsx)("div",{className:"text-xs",children:(0,s.jsx)(N.Z,{code:"p"})})]}),placement:"bottom",children:(0,s.jsx)(d.Z,{mode:"text",padding:"p-1",onClick:c,children:(0,s.jsx)(h.jJ,{className:"inline-block w-8 h-8"})})}),(0,s.jsxs)("div",{className:"inline-flex gap-4 items-center px-2 h-full rounded-lg border grow dark:border-stone-800",children:[(0,s.jsxs)("div",{className:"inline-flex gap-3 items-center",children:[(0,s.jsx)(w,{shortcuts:F}),(0,s.jsx)(b.Z,{mode:"text",variant:"info",title:"Annotation Instructions",label:"Instructions",children:()=>(0,s.jsx)("p",{children:a})}),(0,s.jsxs)("span",{className:"inline-flex gap-1 items-center text-sm whitespace-nowrap",children:[(0,s.jsx)("span",{className:"text-stone-500",children:"#:"}),(0,s.jsx)("span",{className:"font-bold text-blue-500",children:n})]}),(0,s.jsxs)("span",{className:"text-sm inline-flex gap-1 items-center whitespace-nowrap",children:[(0,s.jsx)("span",{className:"text-stone-500",children:"Progress:"}),(0,s.jsx)("div",{className:"w-36",children:(0,s.jsx)(v.Z,{error:Z,verified:k,total:C,complete:f,className:"mb-0"})})]})]}),(0,s.jsxs)("span",{className:"text-sm inline-flex gap-1 items-center whitespace-nowrap text-stone-500",children:[(0,s.jsx)("span",{children:"Remaining:"}),(0,s.jsx)("span",{className:"font-medium text-blue-500",children:m}),"/",C]}),(0,s.jsxs)("div",{className:"inline-flex gap-1 items-center",children:[(0,s.jsx)("span",{className:"text-sm text-stone-500",children:"Pending:"}),(0,s.jsx)(g.Z,{label:"Only Pending",isSelected:null!==(t=o.get("pending"))&&void 0!==t&&t,onChange:e=>{e?o.set("pending",e,!0):o.clear("pending",!0)}})]}),(0,s.jsx)(x.Z,{filter:o,filterDef:j,className:(0,d.y)({variant:"info",mode:"text",padding:"p-1"}),button:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(h.k1,{className:"inline-block mr-1 w-5 h-5"}),(0,s.jsx)("span",{className:"text-sm align-middle whitespace-nowrap",children:"Filters"})]})}),(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsx)(u.Z,{withLabel:!1,filter:o,filterDef:j})})]}),(0,s.jsx)(p.Z,{tooltip:(0,s.jsxs)("div",{className:"inline-flex gap-2 items-center",children:["Next Task",(0,s.jsx)("div",{className:"text-xs",children:(0,s.jsx)(N.Z,{code:"n"})})]}),placement:"bottom",children:(0,s.jsx)(d.Z,{mode:"text",padding:"p-1",onClick:i,children:(0,s.jsx)(h.Ne,{className:"inline-block w-8 h-8"})})})]})}var P=n(71672),_=n(68e3),E=n(6922),R=n(48423),D=n(75728);function M(e){let{tags:t,tagFilter:n,onClick:a,onAddTag:l,onCreateTag:r,onRemoveTag:o,onClearTags:i}=e,c=(0,D.Z)(e=>e.getTagColor);return(0,s.jsxs)(P.Z,{children:[(0,s.jsx)(_.H4,{className:"text-center",children:(0,s.jsxs)(p.Z,{tooltip:(0,s.jsx)("div",{className:"w-48 text-center",children:"The tags selected here will be automatically attached to newly created annotations."}),placement:"top",children:[(0,s.jsx)(h.oE,{className:"inline-block w-5 h-5 mr-1"}),(0,s.jsx)("span",{className:"cursor-help",children:"Tag Palette"})]})}),(0,s.jsxs)("div",{className:"flex flex-row gap-1 w-full",children:[(0,s.jsx)(p.Z,{tooltip:"Clear tags",placement:"top",children:(0,s.jsx)(d.Z,{onClick:i,mode:"text",variant:"danger",children:(0,s.jsx)(h.pJ,{className:"w-5 h-5"})})}),(0,s.jsx)("div",{className:"grow",children:(0,s.jsx)(R.Z,{onSelect:l,onCreate:r,initialFilter:n,placeholder:"Add tags..."})})]}),(0,s.jsx)("div",{className:"flex flex-row flex-wrap gap-1",children:t.map(e=>(0,s.jsx)(E.ZP,{tag:e,...c(e),onClick:()=>null==a?void 0:a(e),onClose:()=>null==o?void 0:o(e)},"".concat(e.key,"-").concat(e.value)))})]})}var H=n(15964),L=n(68148),B=n(35414),V=n(3347),I=n(57485),z=n(57581);function U(e){var t;let{recording:n,onTagClick:a}=e,{path:l}=n,r=(0,B.yZ)(null!==(t=(0,B.eb)(l))&&void 0!==t?t:"");return(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsxs)("div",{className:"flex flex-row justify-start gap-8 items-center",children:[(0,s.jsxs)("div",{className:"inline-flex items-center text-stone-500",children:[(0,s.jsx)(h.He,{className:"inline-block mr-1 w-5 h-5 text-stone-600"}),(0,s.jsxs)(H.Z,{mode:"text",padding:"p-0",variant:"secondary",href:"/recordings/detail/?recording_uuid=".concat(n.uuid),className:"max-w-xl whitespace-nowrap",children:[r,(0,s.jsx)("span",{className:"text-sm text-stone-600",children:".WAV"})]})]}),(0,s.jsx)(V.Z,{latitude:n.latitude,longitude:n.longitude,disabled:!0}),(0,s.jsx)(z.Z,{time:n.time,disabled:!0}),(0,s.jsx)(L.Z,{date:n.date,disabled:!0}),(0,s.jsxs)("div",{className:"text-stone-500 text-sm",children:[(0,s.jsx)("span",{className:"font-semibold",children:"SR"})," ",n.samplerate.toLocaleString()," Hz"]}),(0,s.jsxs)("div",{className:"text-stone-500 text-sm",children:[(0,s.jsx)("span",{className:"font-semibold",children:"C"})," ",n.channels.toLocaleString()]}),(0,s.jsxs)("div",{className:"text-stone-500 text-sm",children:[(0,s.jsx)("span",{className:"font-semibold",children:"TE"})," ",n.time_expansion.toLocaleString()]})]}),(0,s.jsx)(I.Z,{label:"Recording Tags",recording:n,onTagClick:a,disabled:!0})]})}var J=n(55429);function Y(e){var t;let{soundEventAnnotation:n}=e;return(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)(_.H4,{className:"text-center",children:"Sound Event Details"}),(0,s.jsx)(J.iV,{children:"Geometry Type"}),(0,s.jsx)(J.pj,{children:n.sound_event.geometry_type}),(0,s.jsx)("div",{className:"flex flex-row flex-wrap gap-4",children:null===(t=n.sound_event.features)||void 0===t?void 0:t.map(e=>(0,s.jsxs)("div",{children:[(0,s.jsx)(J.iV,{children:e.name}),(0,s.jsx)(J.pj,{children:e.value.toLocaleString()})]},e.name))})]})}var O=n(94776),K=n(95683),Q=n(94401);function q(){return(0,s.jsx)(O.Z,{padding:"p-2",children:"No notes"})}function G(e){let{soundEventAnnotation:t,currentUser:n,onCreateNote:a,onUpdateNote:r,onDeleteNote:o}=e,i=(0,l.useMemo)(()=>t.notes||[],[t]);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(_.H4,{className:"text-center",children:[(0,s.jsx)(h.uH,{className:"inline-block mr-1 w-5 h-5"}),"Sound Event Notes"]}),null!=a&&(0,s.jsx)(K.Z,{onCreate:a}),0===i.length?(0,s.jsx)(q,{}):(0,s.jsx)(Q.Z,{notes:i,currentUser:n,onUpdate:r,onDelete:o})]})}var W=n(49660);function $(){return(0,s.jsx)(O.Z,{padding:"p-2",children:"No tags"})}function X(e){let{soundEventAnnotation:t,tagFilter:n,onAddTag:a,onRemoveTag:r,onClickTag:o,onCreateTag:i}=e,c=(0,l.useMemo)(()=>t.tags||[],[t]),d=(0,D.Z)(e=>e.getTagColor);return(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsxs)(_.H4,{className:"text-center",children:[(0,s.jsx)(h.Dg,{className:"inline-block mr-1 w-5 h-5"}),"Sound Event Tags"]}),(0,s.jsxs)("div",{className:"flex flex-row items-center flex-wrap gap-1",children:[c.map(e=>(0,s.jsx)(E.ZP,{tag:e,...d(e),onClick:()=>null==o?void 0:o(e),onClose:()=>null==r?void 0:r(e)},"".concat(e.key,"-").concat(e.value))),0===c.length&&(0,s.jsx)($,{})]}),(0,s.jsx)("div",{className:"flex flex-row justify-center gap-4 items-center",children:(0,s.jsx)(W.Z,{variant:"primary",onAdd:a,onCreate:i,filter:n,text:"Add tags",placeholder:"Add tags..."})})]})}var ee=n(40127);function et(e){let{soundEventAnnotation:t,clipAnnotation:n,tagFilter:a,onAddTag:l,onRemoveTag:r,onCreateTag:o}=e,i=(0,ee.Z)({uuid:t.uuid,clipAnnotation:n,soundEventAnnotation:t,onAddTag:l,onRemoveTag:r});return(0,s.jsxs)("div",{className:"w-full flex flex-row gap-8 py-4",children:[(0,s.jsx)(P.Z,{className:"grow",children:(0,s.jsxs)("div",{className:"flex flex-col gap-8",children:[(0,s.jsx)(Y,{soundEventAnnotation:i.data||t}),(0,s.jsx)(X,{tagFilter:a,soundEventAnnotation:i.data||t,onAddTag:i.addTag.mutate,onRemoveTag:i.removeTag.mutate,onCreateTag:o})]})}),(0,s.jsx)(P.Z,{className:"grow",children:(0,s.jsx)(G,{soundEventAnnotation:i.data||t,onCreateNote:i.addNote.mutate})})]})}var en=n(40918),es=n(56800),ea=n.n(es);let el={assigned:h.tB,completed:h.nQ,verified:h.SA,rejected:h.wv},er={assigned:"bg-blue-100 border-blue-200 text-blue-500",completed:"bg-emerald-100 border-emerald-200 text-emerald-500",verified:"bg-amber-100 border-amber-200 text-amber-500",rejected:"bg-red-100 border-red-200 text-red-500"};function eo(e){var t;let{badge:n,onClick:a,onRemove:l}=e,{state:r}=n,o=el[r],i=er[r];return(0,s.jsxs)("div",{className:ea()(i,"flex flex-row items-center rounded-full border max-w-fit p-1"),children:[(0,s.jsxs)("button",{type:"button",className:"group focus:outline-none focus:ring-4 focus:ring-emerald-500/50 rounded-md",disabled:null==a,onClick:a,children:[(0,s.jsx)(o,{className:ea()("transition-all w-6 h-6 inline-block",null!=a&&"group-hover:stroke-3")}),(0,s.jsx)("span",{className:ea()("transition-all text-stone-500 text-sm font-thin ml-1",null!=a&&"group-hover:font-medium"),children:null===(t=n.user)||void 0===t?void 0:t.username})]}),null!=l&&(0,s.jsx)("button",{type:"button",className:"ml-1 group focus:outline-none focus:ring-4 focus:ring-emerald-500/50 rounded-md",onClick:l,children:(0,s.jsx)(h.Tw,{className:"transition-all w-4 h-4 group-hover:stroke-3"})})]})}function ei(e){var t;let{task:n,onDone:a,onReview:l,onVerify:r,onRemoveBadge:o}=e;return(0,s.jsxs)("div",{className:"flex flex-row justify-between items-center border rounded-md border-stone-200 dark:border-stone-800 px-6",children:[(0,s.jsx)("div",{className:"flex flex-row flex-wrap gap-2",children:null==n?(0,s.jsx)(en.Z,{}):null===(t=n.status_badges)||void 0===t?void 0:t.map(e=>{var t;return(0,s.jsx)(eo,{badge:e,onRemove:()=>null==o?void 0:o(e.state)},"".concat(e.state,"-").concat(null===(t=e.user)||void 0===t?void 0:t.id))})}),(0,s.jsxs)("div",{className:"flex flex-row gap-2 justify-center",children:[(0,s.jsx)(p.Z,{tooltip:(0,s.jsxs)("div",{className:"inline-flex gap-2 items-center",children:["Task Done!",(0,s.jsx)("div",{className:"text-xs",children:(0,s.jsx)(N.Z,{code:"g"})})]}),placement:"bottom",autoPlacement:!1,children:(0,s.jsx)(d.Z,{mode:"text",variant:"primary",onClick:a,children:(0,s.jsx)(h.nQ,{className:"w-8 h-8"})})}),(0,s.jsx)(p.Z,{tooltip:(0,s.jsxs)("div",{className:"inline-flex gap-2 items-center",children:["Needs Review",(0,s.jsx)("div",{className:"text-xs",children:(0,s.jsx)(N.Z,{code:"r"})})]}),placement:"bottom",autoPlacement:!1,children:(0,s.jsx)(d.Z,{mode:"text",variant:"danger",onClick:l,children:(0,s.jsx)(h.Tw,{className:"w-8 h-8"})})}),(0,s.jsx)(p.Z,{tooltip:(0,s.jsxs)("div",{className:"inline-flex gap-2 items-center",children:["Verified",(0,s.jsx)("div",{className:"text-xs",children:(0,s.jsx)(N.Z,{code:"v"})})]}),placement:"bottom",autoPlacement:!1,children:(0,s.jsx)(d.Z,{mode:"text",variant:"warning",onClick:r,children:(0,s.jsx)(h.SA,{className:"w-8 h-8"})})})]})]})}function ec(){return(0,s.jsx)(O.Z,{padding:"p-2",children:"No notes"})}function ed(e){let{clipAnnotation:t,currentUser:n,onCreateNote:a,onUpdateNote:r,onDeleteNote:o}=e,i=(0,l.useMemo)(()=>(null==t?void 0:t.notes)||[],[t]);return(0,s.jsxs)(P.Z,{children:[(0,s.jsxs)(_.H4,{className:"text-center",children:[(0,s.jsx)(h.uH,{className:"inline-block mr-1 w-5 h-5"}),"Clip Notes"]}),(0,s.jsx)(K.Z,{onCreate:a}),0===i.length?(0,s.jsx)(ec,{}):(0,s.jsx)(Q.Z,{notes:i,currentUser:n,onUpdate:r,onDelete:o})]})}var eu=n(20720);function ex(){return(0,s.jsx)(O.Z,{padding:"p-2",children:"No tags currently registered in this clip."})}function em(e){let{clipAnnotation:t,tagFilter:n,onAddTag:a,onRemoveTag:r,onClickTag:o,onClearTags:i,onCreateTag:c,disabled:u=!1}=e,x=(0,l.useMemo)(()=>(null==t?void 0:t.tags)||[],[t]),m=(0,D.Z)(e=>e.getTagColor);return(0,s.jsxs)(P.Z,{children:[(0,s.jsxs)(_.H4,{className:"text-center",children:[(0,s.jsx)(h.Dg,{className:"inline-block mr-1 w-5 h-5"}),"Clip Tags"]}),(0,s.jsxs)("div",{className:"flex flex-row items-center flex-wrap gap-1",children:[x.map(e=>(0,s.jsx)(E.ZP,{tag:e,...m(e),onClick:()=>null==o?void 0:o(e),onClose:()=>null==r?void 0:r(e)},"".concat(e.key,"-").concat(e.value))),0===x.length&&(0,s.jsx)(ex,{})]}),!u&&(0,s.jsxs)("div",{className:"flex flex-row justify-end gap-4 items-center",children:[(0,s.jsxs)(d.Z,{className:"flex flex-row items-center",onClick:i,mode:"text",variant:"danger",children:["Clear tags ",(0,s.jsx)(h.pJ,{className:"ms-2 w-5 h-5"})]}),(0,s.jsx)(W.Z,{variant:"primary",onAdd:a,onCreate:c,filter:n,text:"Add tags",placeholder:"Add tags..."})]})]})}var ef=n(2857),eh=n(93191),ej=n(40932),eg=n(37051),ev=n(79364),ep=n(19245);let eb={};var eN=n(63038);function ek(e){let{taskFilter:t,tagFilter:n,parameters:a=c._z,annotationTask:o,currentUser:i,instructions:d,onCreateTag:u,onCreateSoundEventAnnotation:x,onUpdateSoundEventAnnotation:m,onAddSoundEventTag:f,onRemoveSoundEventTag:h,onDeleteSoundEventAnnotation:j,onChangeTask:g,onAddClipTag:v,onRemoveClipTag:p,onParameterSave:b,onCompleteTask:N,onRejectTask:w,onVerifyTask:y}=e,[C,T]=(0,l.useState)(null),[S,F]=(0,l.useState)([]),P=function(e){let{filter:t=eb,annotationTask:n,shuffle:s=!1,onChangeTask:a,onCompleteTask:o,onRejectTask:i,onVerifyTask:c}=e,[d,u]=(0,l.useState)(null!=n?n:null),x=(0,eh.NL)(),{items:m,filter:f,isLoading:h,isError:j,queryKey:g}=(0,ev.Z)({pageSize:-1,filter:t,fixed:Object.keys(t)}),v=(0,l.useMemo)(()=>s?(0,ep.S)(m):m,[m,s]),p=(0,l.useMemo)(()=>null===d?-1:v.findIndex(e=>e.uuid===d.uuid),[d,v]),b=(0,l.useCallback)(e=>{x.setQueryData(["annotation_task",e.uuid],e),u(e),null==a||a(e)},[a,x]),N=(0,l.useMemo)(()=>-1!==p?p<v.length-1:v.length>0,[p,v.length]),w=(0,l.useCallback)(()=>{N&&(-1===p?b(v[0]):b(v[p+1]))},[p,v,N,b]),y=(0,l.useMemo)(()=>-1!==p?p>0:v.length>0,[p,v.length]),C=(0,l.useCallback)(()=>{y&&(-1===p?b(v[0]):b(v[p-1]))},[p,v,y,b]),{set:T}=f,S=(0,l.useCallback)((e,t)=>{T(e,t)},[T]),F=(0,l.useCallback)(async()=>{if(null==d)throw Error("No selected task");return eg.Z.annotationTasks.getAnnotations(d)},[d]),A=(0,ej.a)({queryKey:["annotation_task",null==d?void 0:d.uuid,"annotations"],queryFn:F,enabled:null!=d}),P=(0,l.useCallback)(e=>{x.setQueryData(["annotation_task",e.uuid],e),x.setQueryData(g,t=>null==t?t:{...t,items:t.items.map(t=>t.uuid===e.uuid?e:t)}),u(e)},[x,g]),_=(0,l.useCallback)(async()=>{if(null==d)throw Error("No selected task");return eg.Z.annotationTasks.addBadge(d,"completed")},[d]),E=(0,r.D)({mutationFn:_,onSuccess:e=>{P(e),null==o||o(e),w()}}),R=(0,l.useCallback)(async()=>{if(null==d)throw Error("No selected task");return eg.Z.annotationTasks.addBadge(d,"rejected")},[d]),D=(0,r.D)({mutationFn:R,onSuccess:e=>{P(e),null==i||i(e),w()}}),M=(0,l.useCallback)(async()=>{if(null==d)throw Error("No selected task");return eg.Z.annotationTasks.addBadge(d,"verified")},[d]),H=(0,r.D)({mutationFn:M,onSuccess:e=>{P(e),null==c||c(e),w()}}),L=(0,l.useCallback)(async e=>{if(null==d)throw Error("No selected task");return eg.Z.annotationTasks.removeBadge(d,e)},[d]),B=(0,r.D)({mutationFn:L,onSuccess:e=>{P(e)}}),V=(0,l.useCallback)(()=>{if(0===v.length)return;let e=v[Math.floor(Math.random()*v.length)];u(e),null==a||a(e)},[v,a]);return(0,l.useEffect)(()=>{null==d&&v.length>0&&b(v[0])},[d,v,b]),!function(e){let{onGoNext:t,onGoPrevious:n,onMarkCompleted:s,onMarkRejected:a,onMarkVerified:l,enabled:r=!0}=e;(0,k.Z)((0,Z.Z)({enabled:r,key:"n"}),t),(0,k.Z)((0,Z.Z)({enabled:r,key:"p"}),n),(0,k.Z)((0,Z.Z)({enabled:r,key:"g"}),s),(0,k.Z)((0,Z.Z)({enabled:r,key:"r"}),a),(0,k.Z)((0,Z.Z)({enabled:r,key:"v"}),l)}({onGoNext:w,onGoPrevious:C,onMarkCompleted:E.mutate,onMarkRejected:D.mutate,onMarkVerified:H.mutate}),{current:p,task:d,filter:f.filter,tasks:v,isLoading:h,isError:j,goToTask:b,hasNextTask:N,hasPrevTask:y,nextTask:w,prevTask:C,setFilter:S,annotations:A,markCompleted:E,markRejected:D,markVerified:H,removeBadge:B,selectRandomTask:V,_filter:f}}({filter:t,annotationTask:o,onChangeTask:g,onCompleteTask:N,onRejectTask:w,onVerifyTask:y}),{data:_,isLoading:E}=P.annotations,{data:R,addTag:D,removeTag:H,addNote:L,removeNote:B}=(0,eN.Z)({uuid:null==_?void 0:_.uuid,clipAnnotation:_,onAddTag:v,onRemoveTag:p,enabled:null!=_}),V=(0,l.useCallback)(async()=>{var e;let t=null==_?void 0:null===(e=_.tags)||void 0===e?void 0:e.slice(0);if(null!=t)for(let e of t)await H.mutateAsync(e)},[_,H]),I=(0,l.useCallback)(e=>{F(t=>t.some(t=>t.key===e.key&&t.value===e.value)?t:[...t,e])},[]),z=(0,l.useCallback)(e=>{F(t=>t.filter(t=>t.key!==e.key||t.value!==e.value))},[]),J=(0,l.useCallback)(()=>{F([])},[]);return P.isLoading?(0,s.jsx)(ef.Z,{}):P.isError?(0,s.jsx)("div",{children:"Error loading annotation tasks"}):null==P.task?(0,s.jsx)(O.Z,{children:"No tasks available"}):(0,s.jsxs)("div",{className:"w-full flex flex-col gap-3",children:[(0,s.jsxs)("div",{className:"flex flex-row justify-between gap-8",children:[(0,s.jsx)("div",{className:"grow",children:(0,s.jsx)(A,{current:P.current,instructions:d,tasks:P.tasks,filter:P._filter,onNext:P.nextTask,onPrevious:P.prevTask})}),(0,s.jsx)("div",{className:"w-[30rem] flex-none",children:null!=P.task&&(0,s.jsx)(ei,{task:P.task,onReview:P.markRejected.mutate,onDone:P.markCompleted.mutate,onVerify:P.markVerified.mutate,onRemoveBadge:P.removeBadge.mutate})})]}),(0,s.jsxs)("div",{className:"flex flex-row w-full gap-8",children:[(0,s.jsx)("div",{className:"grow flex flex-col gap-2",children:E?(0,s.jsx)(ef.Z,{}):null==R?(0,s.jsx)(eZ,{}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(U,{recording:R.clip.recording,onTagClick:I}),(0,s.jsx)(eu.Z,{parameters:a,clipAnnotation:R,defaultTags:S,onParameterSave:b,onSelectAnnotation:T,tagFilter:n,onCreateTag:u,onAddSoundEventTag:f,onRemoveSoundEventTag:h,onCreateSoundEventAnnotation:x,onUpdateSoundEventAnnotation:m,onDeleteSoundEventAnnotation:j}),null==C?(0,s.jsx)(O.Z,{children:"No sound event selected. Select a sound event to view details."}):(0,s.jsx)(et,{clipAnnotation:R,tagFilter:n,soundEventAnnotation:C,onAddTag:f,onCreateTag:u,onRemoveTag:h})]})}),(0,s.jsxs)("div",{className:"w-[30rem] flex-none flex flex-col gap-4",children:[(0,s.jsx)(M,{tags:S,tagFilter:n,onClick:D.mutate,onCreateTag:u,onAddTag:I,onRemoveTag:z,onClearTags:J}),(0,s.jsx)(em,{tagFilter:n,clipAnnotation:R,onAddTag:D.mutate,onRemoveTag:H.mutate,onClearTags:V,onCreateTag:u}),(0,s.jsx)(ed,{onCreateNote:L.mutate,onDeleteNote:B.mutate,clipAnnotation:R,currentUser:i})]})]})]})}function eZ(){return(0,s.jsx)(O.Z,{children:"No clip selected"})}var ew=n(26731),ey=n(60410);function eC(){let e=(0,a.useSearchParams)(),t=(0,a.usePathname)(),n=(0,a.useRouter)(),c=(0,l.useContext)(ey.Z),d=(0,l.useContext)(i.Z),u=e.get("annotation_task_uuid"),x=function(e){let{uuid:t,annotationTask:n,enabled:s=!0,withAnnotations:a=!1,onDelete:l,onAddBadge:r,onRemoveBadge:o,onError:i}=e,{query:c,useMutation:d,useQuery:u,useDestruction:x}=(0,ew.ZP)({uuid:t,initial:n,name:"annotation_task",enabled:s,getFn:eg.Z.annotationTasks.get,onError:i}),m=u({name:"annotations",queryFn:eg.Z.annotationTasks.getAnnotations,enabled:a});m.error&&console.error(m.error);let f=x({mutationFn:eg.Z.annotationTasks.delete,onSuccess:l}),h=d({mutationFn:eg.Z.annotationTasks.addBadge,onSuccess:r}),j=d({mutationFn:eg.Z.annotationTasks.removeBadge,onSuccess:o});return{...c,addBadge:h,removeBadge:j,delete:f,annotations:m}}({uuid:u||"",enabled:!!u}),m=(0,D.Z)(e=>e.spectrogramSettings),f=(0,D.Z)(e=>e.setSpectrogramSettings),h=(0,l.useCallback)(e=>{o.ZP.success("Spectrogram settings saved."),f(e)},[f]),{mutate:j}=(0,r.D)({mutationFn:async e=>await eg.Z.annotationProjects.addTag(c,e)}),g=(0,l.useCallback)(s=>{let a=function(e){let{pathname:t,search:n,param:s,value:a}=e,l=new URL(t,window.location.origin),r=new URLSearchParams(n);return r.set(s,a),"".concat(l.toString(),"?").concat(r.toString())}({pathname:t,search:e,param:"annotation_task_uuid",value:s.uuid});n.push(a)},[n,t,e]),v=(0,l.useCallback)(()=>{o.ZP.success("Task marked as complete.")},[]),p=(0,l.useCallback)(()=>{o.ZP.error("Task marked for review.")},[]),b=(0,l.useCallback)(()=>{o.ZP.success("Task verified.")},[]),N=(0,l.useMemo)(()=>({annotation_project:c}),[c]);return x.isLoading&&!x.data?(0,s.jsx)(ef.Z,{}):(0,s.jsx)(ek,{instructions:c.annotation_instructions||"",taskFilter:N,tagFilter:N,annotationTask:x.data,parameters:m,onChangeTask:g,currentUser:d,onParameterSave:h,onCompleteTask:v,onRejectTask:p,onVerifyTask:b,onCreateTag:j})}},60410:function(e,t,n){"use strict";let s=(0,n(2265).createContext)({name:"",description:"",tags:[],created_on:new Date,uuid:""});t.Z=s},19985:function(e,t,n){"use strict";let s=(0,n(2265).createContext)({id:"",username:"",email:""});t.Z=s},40918:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var s=n(57437),a=n(4933);function l(){return(0,s.jsx)("div",{className:"w-full h-full flex flex-row justify-center items-center",children:(0,s.jsx)(a.Z,{})})}},55429:function(e,t,n){"use strict";n.d(t,{iV:function(){return c},pj:function(){return i},ue:function(){return d}});var s=n(57437),a=n(56800),l=n.n(a),r=n(2265),o=n(14088);function i(e){let{children:t,className:n,...a}=e;return(0,s.jsx)("dd",{className:l()("mt-1 text-sm leading-6 text-stone-700 dark:text-stone-400 sm:col-span-2 sm:mt-0",n),...a,children:t})}function c(e){let{children:t,className:n,...a}=e;return(0,s.jsx)("dt",{className:l()("text-sm font-medium leading-6 text-stone-900 dark:text-stone-300",n),...a,children:t})}function d(e){let{children:t,Input:n,value:a,onChange:l,...c}=e,[d,u]=(0,r.useState)(!1),[x,m]=(0,r.useState)(a);return d?(0,s.jsx)(i,{children:(0,s.jsx)(n,{value:x,onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(l(x),u(!1)),"Escape"===e.key&&(m(a),u(!1))},onBlur:()=>{m(a),u(!1)},onChange:e=>m(e.target.value),...c})}):(0,s.jsxs)(i,{className:"flex flex-row justify-between",children:[t,(0,s.jsx)("button",{onClick:()=>u(!0),className:"text-sm text-stone-500 underline ml-2",children:(0,s.jsx)(o.dY,{className:"w-5 h-5 inline-block text-blue-500"})})]})}},57605:function(e,t,n){"use strict";n.d(t,{Z:function(){return c},t:function(){return d}});var s=n(57437),a=n(59226),l=n(24880),r=n(2265),o=n(12098),i=n(14088);function c(e){let{title:t,children:n,label:a,open:l=!1,width:i="max-w-md",...c}=e,[u,x]=(0,r.useState)(l);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.Z,{type:"button",onClick:()=>x(!0),...c,children:a}),(0,s.jsx)(d,{title:(0,s.jsx)("div",{children:t}),isOpen:u,onClose:()=>x(!1),children:e=>{let{close:t}=e;return(0,s.jsx)("div",{className:i,children:n({close:t})})}})]})}function d(e){let{title:t,children:n,onClose:c,isOpen:d=!0}=e;return(0,s.jsx)(a.u,{appear:!0,show:d,as:r.Fragment,children:(0,s.jsxs)(l.V,{as:"div",className:"relative z-50",onClose:()=>null==c?void 0:c(),children:[(0,s.jsx)(a.u.Child,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-25"})}),(0,s.jsx)("div",{className:"overflow-y-auto fixed inset-0",children:(0,s.jsx)("div",{className:"flex justify-center items-center p-4 min-h-full text-center",children:(0,s.jsx)(a.u.Child,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,s.jsxs)(l.V.Panel,{className:"overflow-hidden p-6 w-full text-left align-middle rounded-2xl shadow-xl transition-all transform max-w-fit bg-stone-50 text-stone-700 z-[99999] dark:bg-stone-700 dark:text-stone-300",children:[(0,s.jsxs)(l.V.Title,{as:"div",className:"mb-4 flex flex-row justify-between items-center gap-4",children:[null!=t&&(0,s.jsx)("h3",{className:"text-lg font-medium leading-6 text-stone-900 dark:text-stone-100",children:t}),(0,s.jsx)(o.Z,{onClick:()=>null==c?void 0:c(),variant:"secondary",mode:"text",children:(0,s.jsx)(i.Tw,{className:"w-5 h-5"})})]}),(0,s.jsx)("div",{className:"mt-2",children:n({close:()=>null==c?void 0:c()})})]})})})})]})})}},94776:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var s=n(57437);function a(e){let{children:t,padding:n="p-8"}=e;return(0,s.jsx)("div",{className:"".concat(n," w-full"),children:(0,s.jsx)("div",{className:"flex flex-col justify-center items-center p-4 w-full text-center rounded-md border border-dashed border-stone-500 text-stone-500",children:t})})}},68e3:function(e,t,n){"use strict";n.d(t,{H1:function(){return r},H2:function(){return o},H3:function(){return i},H4:function(){return c}});var s=n(57437),a=n(56800),l=n.n(a);function r(e){let{children:t,className:n,...a}=e;return(0,s.jsx)("h1",{className:l()("text-2xl font-bold text-stone-800 dark:text-stone-300",n),...a,children:t})}function o(e){let{children:t,className:n,...a}=e;return(0,s.jsx)("h2",{className:l()("text-xl font-bold text-stone-800 dark:text-stone-300",n),...a,children:t})}function i(e){let{children:t,className:n,...a}=e;return(0,s.jsx)("h3",{className:l()("text-lg font-semibold leading-7 items-center text-stone-800 dark:text-stone-300",n),...a,children:t})}function c(e){let{children:t,className:n,...a}=e;return(0,s.jsx)("h4",{className:l()(n,"text-md font-semibold leading-6 text-stone-800 dark:text-stone-300"),...a,children:t})}},15964:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var s=n(57437),a=n(56800),l=n.n(a),r=n(87138),o=n(12098);function i(e){let{children:t,variant:n="primary",mode:a="filled",padding:i="p-2.5",className:c,...d}=e,u=(0,o.y)({variant:n,mode:a,padding:i});return(0,s.jsx)(r.default,{...d,className:l()(u,c),children:t})}},87576:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var s=n(57437),a=n(49896),l=n(35933);function r(e){let{button:t,children:n,placement:r="bottom",offset:o=4,autoPlacement:i=!1}=e;return(0,s.jsx)(a.J,{as:"div",className:"inline-block text-left",children:(0,s.jsxs)(l.bv,{zIndex:10,placement:r,offset:o,enter:"transition duration-200 ease-out",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition duration-150 ease-in",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",portal:!0,autoPlacement:i,children:[(0,s.jsx)(a.J.Button,{as:"div",children:t}),(0,s.jsx)(a.J.Panel,{className:"w-72",focus:!0,unmount:!0,children:e=>{let{close:t}=e;return n({close:t})}})]})})}},75716:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var s=n(57437),a=n(56800),l=n.n(a);function r(e){let{total:t,complete:n,verified:a=0,error:r=0,className:o="mb-4"}=e,i=n/t*100,c=a/t*100,d=r/t*100,u=100-i-c-d;return(0,s.jsxs)("div",{className:l()(o,"w-full flex flex-row h-4 overflow-hidden bg-stone-200 rounded-full dark:bg-stone-700"),children:[(0,s.jsx)("div",{className:"flex flex-row items-center justify-center h-4 bg-blue-600 dark:bg-blue-400 text-blue-100 dark:text-blue-900",style:{width:"".concat(u,"%")},children:u>=10?"".concat(u.toPrecision(3),"%"):""}),(0,s.jsx)("div",{className:"flex flex-row items-center justify-center h-4 bg-red-600 dark:bg-red-400 text-red-100 dark:text-red-900",style:{width:"".concat(d,"%")},children:d>=10?"".concat(d.toPrecision(3),"%"):""}),(0,s.jsx)("div",{className:"flex flex-row items-center justify-center h-4 bg-emerald-600 dark:bg-emerald-400 text-emerald-100 dark:text-emerald-500",style:{width:"".concat(i,"%")},children:i>=10?"".concat(i.toPrecision(3),"%"):""}),(0,s.jsx)("div",{className:"flex flex-row items-center justify-center h-4 bg-amber-600 dark:bg-amber-400 text-amber-100 dark:text-amber-900",style:{width:"".concat(c,"%")},children:c>=10?"".concat(c.toPrecision(3),"%"):""})]})}},95683:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var s=n(57437),a=n(2265),l=n(12098),r=n(14088),o=n(93847);function i(e){let{onCreate:t}=e,[n,i]=(0,a.useState)("");return(0,s.jsxs)("div",{className:"flex flex-col p-4 w-full",children:[(0,s.jsx)(o.BZ,{label:"Add a note",name:"message",help:"Write the note message and click on the type of note you want to create.",children:(0,s.jsx)(o.Kx,{name:"message",value:n,placeholder:"Type your note here...",onChange:e=>i(e.target.value)})}),(0,s.jsxs)("div",{className:"flex flex-row gap-4 justify-end",children:[(0,s.jsxs)(l.Z,{variant:"danger",mode:"text",onClick:()=>{i(""),null==t||t({message:n,is_issue:!0})},children:[(0,s.jsx)(r.uN,{className:"inline-block mr-1 w-5 h-5"}),"Add Issue"]}),(0,s.jsxs)(l.Z,{variant:"primary",mode:"text",onClick:()=>{i(""),null==t||t({message:n,is_issue:!1})},children:[(0,s.jsx)(r.uH,{className:"inline-block mr-1 w-5 h-5"}),"Add Note"]})]})]})}},94401:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var s=n(57437);n(2265);var a=n(46033);function l(e){let{notes:t,currentUser:n,onUpdate:l,onDelete:r}=e;return(0,s.jsx)("ul",{"aria-label":"feed",role:"feed",className:"flex relative flex-col gap-12 py-12 pl-6 before:absolute before:top-0 before:left-6 before:h-full before:-translate-x-1/2 before:border before:border-dashed before:border-stone-200 before:dark:border-stone-700 after:absolute after:top-6 after:left-6 after:bottom-6 after:-translate-x-1/2 after:border after:border-stone-200 after:dark:border-stone-700",children:t.map(e=>(0,s.jsx)(a.Z,{note:e,currentUser:n,onUpdate:l,onDelete:r},e.uuid))})}},46033:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}});var s=n(57437),a=n(12098),l=n(14088),r=n(2857),o=n(37051),i=n(26731);function c(e){var t,n;let{note:c,currentUser:d,actions:u,onUpdate:x,onDelete:m}=e,f=function(e){let{uuid:t,note:n,onUpdate:s,onDelete:a,enabled:l=!0}=e;if(void 0!==n&&n.uuid!==t)throw Error("Note uuid does not match");let{query:r,useMutation:c}=(0,i.ZP)({uuid:t,initial:n,name:"note",enabled:l,getFn:o.Z.notes.get}),d=c({mutationFn:o.Z.notes.update,onSuccess:s}),u=c({mutationFn:o.Z.notes.delete,onSuccess:a});return{...r,update:d,delete:u}}({uuid:c.uuid,note:c,onUpdate:x});return f.isLoading||null==f.data?(0,s.jsx)(r.Z,{}):(0,s.jsx)("li",{role:"article",className:"relative p-2 pl-6",children:(0,s.jsxs)("div",{className:"flex flex-col flex-1 gap-2",children:[(0,s.jsx)("div",{className:"flex absolute -left-3 z-10 flex-row justify-center items-center w-6 h-6 rounded-full bg-stone-100 dark:bg-stone-900",children:f.data.is_issue?(0,s.jsx)(l.uN,{className:"inline-block w-5 h-5 text-red-500"}):(0,s.jsx)(l.Zi,{className:"inline-block w-5 h-5 text-ston-500"})}),(0,s.jsxs)("h4",{className:"flex flex-col items-start text-base font-medium leading-6 md:flex-row lg:items-center text-stone-700 dark:text-stone-300",children:[(0,s.jsx)("span",{className:"flex-1",children:(null===(t=c.created_by)||void 0===t?void 0:t.username)||"anonymous"}),(0,s.jsxs)("span",{className:"text-xs font-normal text-stone-400",children:[" ",f.data.created_on.toLocaleString()]})]}),(0,s.jsx)("p",{className:"text-sm text-stone-500",children:f.data.message}),(0,s.jsxs)("div",{className:"flex flex-row gap-4 justify-end",children:[u,f.data.is_issue&&(0,s.jsxs)(a.Z,{mode:"text",variant:"warning",className:"text-xs",onClick:()=>f.update.mutate({is_issue:!1}),children:[(0,s.jsx)(l.uN,{className:"inline-block mr-1 w-4 h-4"}),"Resolve"]}),(null==d?void 0:d.id)===(null===(n=f.data.created_by)||void 0===n?void 0:n.id)?(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(a.Z,{mode:"text",variant:"danger",className:"text-xs",onClick:()=>null==m?void 0:m(f.data),children:[(0,s.jsx)(l.pJ,{className:"inline-block mr-1 w-4 h-4"}),"Remove"]})}):null]})]})})}},68148:function(e,t,n){"use strict";n.d(t,{Z:function(){return h}});var s=n(57437),a=n(2265),l=n(39343),r=n(59772),o=n(12098),i=n(71672),c=n(14088),d=n(93847),u=n(87576),x=n(42503);function m(e){let{date:t,disabled:n}=e;return(0,s.jsxs)(o.Z,{mode:"text",variant:"secondary",padding:"py-1",disabled:n,children:[(0,s.jsx)(c.IH,{className:"inline-block mr-1 w-5 h-5 text-stone-500"}),null!=t?t.toLocaleDateString():(0,s.jsx)("span",{className:"text-sm text-stone-400 dark:text-stone-600",children:"-"})]})}let f=r.z.object({date:r.z.coerce.date().nullish()});function h(e){let{date:t,onChange:n,disabled:r=!1}=e,{register:h,handleSubmit:j,watch:g}=(0,l.cI)({mode:"onChange",values:{date:null==t?"":t.toISOString().split("T")[0]},disabled:r}),v=(0,a.useCallback)(e=>{let{date:t}=f.parse({date:""===e.date?null:e.date});null==n||n({date:t})},[n]);(0,x.Z)({onSubmit:v,watch:g,handleSubmit:j});let[p]=g(["date"]);return r?(0,s.jsx)(m,{date:t,disabled:!0}):(0,s.jsx)(u.Z,{button:(0,s.jsx)(m,{date:t}),children:()=>(0,s.jsxs)(i.Z,{className:"bg-stone-800",children:[(0,s.jsx)(d.BZ,{name:"date",label:"Date",help:"Change date of recording. Format: YYYY-MM-DD",children:(0,s.jsx)(d.II,{type:"date",...h("date"),value:p})}),(0,s.jsxs)(o.Z,{mode:"text",variant:"danger",onClick:()=>null==n?void 0:n({date:null}),children:[(0,s.jsx)(c.Tw,{className:"inline-block mr-1 w-5 h-5"}),"Clear"]})]})})}},35414:function(e,t,n){"use strict";n.d(t,{ZP:function(){return f},eb:function(){return x},yZ:function(){return m}});var s=n(57437),a=n(88726),l=n(68e3),r=n(14088),o=n(237),i=n(83192),c=n(68148),d=n(3347),u=n(57581);function x(e){var t;return null===(t=e.split("\\").pop())||void 0===t?void 0:t.split("/").pop()}function m(e){return e.split(".").slice(0,-1).join(".")}function f(e){var t;let{recording:n}=e,{path:f}=n,h=m(null!==(t=x(f))&&void 0!==t?t:""),{data:j,update:g}=(0,i.Z)({uuid:n.uuid,recording:n,enabled:!0});return(0,s.jsxs)("div",{className:"flex overflow-x-auto flex-row gap-x-6 items-center w-full",children:[(0,s.jsxs)("div",{className:"inline-flex items-center",children:[(0,s.jsx)(r.He,{className:"inline-block mr-1 w-5 h-5 text-stone-500"}),(0,s.jsx)(l.H3,{className:"max-w-xl whitespace-nowrap",children:(0,s.jsx)(o.Z,{tooltip:(0,s.jsxs)("div",{className:"w-96 text-sm font-thin tracking-tighter whitespace-normal break-all dark:bg-stone-700 dark:border-stone-800",children:[(0,s.jsx)("span",{className:"font-normal text-blue-500",children:"Full path:"})," ",f]}),placement:"bottom",children:(0,s.jsxs)("button",{type:"button",className:"overflow-hidden w-full text-ellipsis",onClick:()=>{navigator.clipboard.writeText(f),a.ZP.success("Copied full path to clipboard")},children:[h,(0,s.jsx)("span",{className:"text-sm text-stone-500",children:".WAV"})]})})})]}),(0,s.jsx)(d.Z,{latitude:null==j?void 0:j.latitude,longitude:null==j?void 0:j.longitude,onChange:g.mutate}),(0,s.jsx)(u.Z,{time:null==j?void 0:j.time,onChange:g.mutate}),(0,s.jsx)(c.Z,{date:null==j?void 0:j.date,onChange:g.mutate})]})}},3347:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var s=n(57437),a=n(12098),l=n(71672),r=n(14088),o=n(30482),i=n(87576);function c(e){let{latitude:t,longitude:n,disabled:l}=e,i=null!=t&&null!=n;return(0,s.jsxs)(a.Z,{mode:"text",variant:"secondary",padding:"py-1",disabled:l,children:[(0,s.jsx)(r._t,{className:"inline-block mr-1 w-5 h-5 text-stone-500"}),i?(0,o.T)({latitude:t,longitude:n}):(0,s.jsx)("span",{className:"text-sm text-stone-400 dark:text-stone-600",children:"No location"})]})}function d(e){let{latitude:t,longitude:n,onChange:d,disabled:u}=e;return(null==t||null==n)&&u?(0,s.jsx)(c,{latitude:t,longitude:n,disabled:!0}):(0,s.jsx)(i.Z,{button:(0,s.jsx)(c,{latitude:t,longitude:n}),children:()=>(0,s.jsxs)(l.Z,{className:"bg-stone-800 w-80",children:[(0,s.jsx)(o.Z,{value:{latitude:t,longitude:n},onChange:d,disabled:u}),!u&&(0,s.jsxs)(a.Z,{mode:"text",variant:"danger",onClick:()=>null==d?void 0:d({latitude:null,longitude:null}),children:[(0,s.jsx)(r.Tw,{className:"inline-block mr-1 w-5 h-5"}),"Clear"]})]})})}},57485:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var s=n(57437),a=n(2265),l=n(14088),r=n(49660),o=n(6922),i=n(83192),c=n(75728);function d(e){let{recording:t,label:n="Tags",onAddTag:d,onTagClick:u,onRemoveTag:x,disabled:m=!1}=e,f=(0,c.Z)(e=>e.getTagColor),{data:{tags:h}={},addTag:{mutate:j},removeTag:{mutate:g}}=(0,i.Z)({uuid:t.uuid,recording:t,onAddTag:d,onRemoveTag:x}),{handleAddTag:v,handleRemoveTag:p}=(0,a.useMemo)(()=>m?{}:{handleAddTag:j,handleRemoveTag:g},[j,m,g]);return(0,s.jsxs)("div",{className:"flex flex-row gap-2 items-center",children:[(0,s.jsxs)("div",{className:"inline-flex",children:[(0,s.jsx)(l.lO,{className:"inline-block mr-1 w-5 h-5 text-stone-400 dark:text-stone-600"}),(0,s.jsx)("span",{className:"text-sm text-stone-500 font-medium",children:n})]}),(0,s.jsxs)("div",{className:"flex flex-row flex-wrap gap-2",children:[null==h?void 0:h.map(e=>(0,s.jsx)(o.ZP,{tag:e,...f(e),onClick:()=>null==u?void 0:u(e),onClose:()=>null==p?void 0:p(e)},"".concat(e.key,"-").concat(e.value))),(null==h?void 0:h.length)===0&&(0,s.jsx)("span",{className:"text-stone-400 dark:text-stone-600 text-sm",children:"No tags"}),!m&&(0,s.jsx)(r.Z,{variant:"primary",onAdd:v})]})]})}},57581:function(e,t,n){"use strict";n.d(t,{Z:function(){return h}});var s=n(57437),a=n(31014),l=n(2265),r=n(39343),o=n(59772),i=n(12098),c=n(71672),d=n(14088),u=n(93847),x=n(87576),m=n(42503);function f(e){let{time:t,disabled:n}=e;return(0,s.jsxs)(i.Z,{mode:"text",variant:"secondary",padding:"py-1",disabled:n,children:[(0,s.jsx)(d.wZ,{className:"inline-block mr-1 w-5 h-5 text-stone-500"}),null!=t?t:(0,s.jsx)("span",{className:"text-sm text-stone-400 dark:text-stone-600",children:"-"})]})}function h(e){let{time:t,onChange:n,disabled:h=!1}=e,{register:j,handleSubmit:g,watch:v,formState:{errors:p}}=(0,r.cI)({disabled:h,mode:"onBlur",values:{time:t},resolver:(0,a.F)(o.z.object({time:o.z.string().regex(/^\d{2}:\d{2}(:\d{2}(\.\d+)?)?$/,{message:"Time must be in hh:mm:ss.ddd format"}).nullable().optional()}))}),b=(0,l.useCallback)(e=>{null==n||n({time:""===e.time?null:e.time})},[n]);return((0,m.Z)({onSubmit:b,watch:v,handleSubmit:g}),h)?(0,s.jsx)(f,{time:t,disabled:!0}):(0,s.jsx)(x.Z,{button:(0,s.jsx)(f,{time:t}),children:()=>{var e;return(0,s.jsxs)(c.Z,{className:"bg-stone-800",children:[(0,s.jsx)(u.BZ,{name:"time",label:"Time",error:null===(e=p.time)||void 0===e?void 0:e.message,children:(0,s.jsx)(u.II,{type:"text",...j("time"),pattern:"^([0-9]{2}:)?[0-9]{2}:[0-9]{2}(\\.[0-9]{3})?$"})}),(0,s.jsxs)(i.Z,{mode:"text",variant:"danger",onClick:()=>null==n?void 0:n({time:null}),children:[(0,s.jsx)(d.Tw,{className:"inline-block mr-1 w-5 h-5"}),"Clear"]})]})}})}},49660:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var s=n(57437),a=n(49896),l=n(35933),r=n(12098),o=n(14088),i=n(48423);function c(e){let{onClose:t,onCreate:n,onAdd:a,filter:l,...r}=e;return(0,s.jsx)(i.Z,{onSelect:e=>{null==a||a(e)},onCreate:e=>{null==n||n(e),null==a||a(e)},autoFocus:!0,onKeyDown:e=>{"Escape"===e.key?null==t||t():"Enter"===e.key&&(null==t||t())},initialFilter:l,...r})}function d(e){let{onAdd:t,onCreate:n,text:i="add",variant:d="secondary",filter:u,...x}=e;return(0,s.jsx)(a.J,{as:"div",className:"inline-block text-left",children:(0,s.jsxs)(l.bv,{zIndex:20,placement:"bottom",offset:4,enter:"transition duration-200 ease-out",enterFrom:"scale-95 opacity-0",enterTo:"scale-100 opacity-100",leave:"transition duration-150 ease-in",leaveFrom:"scale-100 opacity-100",leaveTo:"scale-95 opacity-0",portal:!0,children:[(0,s.jsx)(a.J.Button,{as:"div",children:(0,s.jsxs)(r.Z,{mode:"text",variant:d,padding:"py-1",children:[(0,s.jsx)(o.dt,{className:"inline-block w-5 h-5 align-middle"}),i]})}),(0,s.jsx)(a.J.Panel,{className:"w-72",focus:!0,unmount:!0,children:e=>{let{close:a}=e;return(0,s.jsx)(c,{onClose:a,onAdd:t,onCreate:n,filter:u,...x})}})]})})}},79364:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var s=n(37051),a=n(33833),l=n(30635);let r={},o=[];function i(){let{filter:e=r,fixed:t=o,pageSize:n=10,enabled:i=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=(0,a.Z)({defaults:e,fixed:t}),{query:d,pagination:u,items:x,total:m,queryKey:f}=(0,l.Z)({name:"annotation_tasks",queryFn:s.Z.annotationTasks.getMany,pageSize:n,filter:c.filter,enabled:i});return{...d,items:x,filter:c,pagination:u,total:m,queryKey:f}}},83192:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var s=n(2265),a=n(37051),l=n(26731);function r(e){let{uuid:t,recording:n,enabled:r=!0,onUpdate:o,onDelete:i,onAddTag:c,onAddNote:d,onRemoveTag:u,onAddFeature:x,onRemoveFeature:m,onUpdateFeature:f,onError:h}=e;if(void 0!==n&&n.uuid!==t)throw Error("Recording uuid does not match");let{query:j,useMutation:g,setData:v}=(0,l.ZP)({uuid:t,initial:n,name:"dataset",enabled:r,getFn:a.Z.recordings.get,onError:h}),p=g({mutationFn:a.Z.recordings.update,onSuccess:o}),b=g({mutationFn:a.Z.recordings.addTag,onSuccess:c}),N=g({mutationFn:a.Z.recordings.removeTag,onSuccess:u}),k=g({mutationFn:a.Z.recordings.addNote,onSuccess:d}),Z=g({mutationFn:a.Z.recordings.addFeature,onSuccess:x}),w=g({mutationFn:a.Z.recordings.removeFeature,onSuccess:m}),y=g({mutationFn:a.Z.recordings.updateFeature,onSuccess:f}),C=g({mutationFn:a.Z.recordings.delete,onSuccess:i}),T=(0,s.useMemo)(()=>null==j.data?null:a.Z.audio.getDownloadUrl({recording:j.data}),[j.data]);return{...j,update:p,addTag:b,removeTag:N,addNote:k,addFeature:Z,removeFeature:w,updateFeature:y,delete:C,set:v,downloadURL:T}}},40127:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var s=n(2265),a=n(37051),l=n(26731);function r(e){let{uuid:t,soundEventAnnotation:n,clipAnnotation:r,onDelete:o,onUpdate:i,onAddTag:c,onRemoveTag:d,onAddNote:u,onError:x,enabled:m=!0,withRecording:f=!1}=e,{query:h,useQuery:j,useMutation:g,useDestruction:v,client:p}=(0,l.ZP)({name:"sound_event_annotation",uuid:t,initial:n,enabled:m,getFn:a.Z.soundEventAnnotations.get,onError:x}),b=j({name:"annotations",queryFn:(0,s.useMemo)(()=>f?()=>{if(null==h.data)throw Error("Cannot get recording for sound event annotation without recording");return a.Z.soundEvents.getRecording(h.data.sound_event)}:()=>{throw Error("Cannot get recording for sound event annotation without recording")},[h.data,f]),enabled:f&&null!=h.data}),N=(0,s.useCallback)(e=>{null!=r&&p.setQueryData(["clip_annotation",r.uuid],t=>{var n;if(null!=t)return{...t,sound_events:null===(n=t.sound_events)||void 0===n?void 0:n.map(t=>t.uuid===e.uuid?e:t)}})},[p,r]),k=(0,s.useCallback)(e=>{null==i||i(e),N(e)},[i,N]),Z=g({mutationFn:a.Z.soundEventAnnotations.update,onSuccess:k}),w=(0,s.useCallback)(e=>{null==o||o(e),N(e)},[o,N]),y=v({mutationFn:a.Z.soundEventAnnotations.delete,onSuccess:w}),C=(0,s.useCallback)(e=>{null==c||c(e),N(e)},[c,N]),T=g({mutationFn:a.Z.soundEventAnnotations.addTag,onSuccess:C}),S=(0,s.useCallback)(e=>{null==d||d(e),N(e)},[d,N]),F=g({mutationFn:a.Z.soundEventAnnotations.removeTag,onSuccess:S}),A=(0,s.useCallback)(e=>{null==u||u(e),N(e)},[u,N]),P=g({mutationFn:a.Z.soundEventAnnotations.addNote,onSuccess:A});return{...h,update:Z,delete:y,addTag:T,removeTag:F,addNote:P,recording:b}}},21165:function(e,t,n){"use strict";function s(e){let t=0,n=0,s=0,a=0;for(let r of e){var l;let e=!1,o=!1,i=!1;null===(l=r.status_badges)||void 0===l||l.forEach(t=>{let{state:n}=t;switch(n){case"verified":e=!0;break;case"rejected":i=!0;break;case"completed":o=!0}}),e&&!i&&(a+=1),o&&!i?s+=1:t+=1,i&&(n+=1)}return{missing:t,needReview:n,completed:s,verified:a,total:e.length}}n.d(t,{q:function(){return s}})},19245:function(e,t,n){"use strict";function s(e){let t=e.slice(0);for(var n=t.length-1;n>0;n--){var s=Math.floor(Math.random()*(n+1)),a=t[n];t[n]=t[s],t[s]=a}return t}function a(e,t){for(var n,s,a=e.slice(0),l=e.length;l--;)n=a[s=Math.floor((l+1)*Math.random())],a[s]=a[l],a[l]=n;return a.slice(0,t)}n.d(t,{S:function(){return s},o:function(){return a}})}},function(e){e.O(0,[8173,8083,5790,3277,231,932,9226,4898,3215,8726,6845,4880,8026,595,6151,7771,873,7051,3847,2302,1780,1479,3511,6652,2971,7023,1744],function(){return e(e.s=36459)}),_N_E=e.O()}]);