import{N as f,t as c,O as w,_ as k,Q as u,R as A,aA as G,L as s,T as i,bA as T,aN as e,aO as I,aP as v,ad as m}from"./admin-drawer-panel-C34Ze3-5.js";import{A as V,G as S,a as D,b as N,c as j,R as E}from"./relation-chips-CAC5ytqH.js";import{a as y}from"./main-Cavvqkyp.js";import{V as H}from"./VTextField-Da_Hs7ls.js";import{V as g,a as O}from"./VRadioGroup-DULWiMSI.js";import"./VDialog-DiixpkQL.js";import"./VSelect-BnoCfCLY.js";import"./VSelectionControl-BSL0qeL9.js";import"./VCheckboxBtn-m4IbdjEe.js";import"./VSlideGroup-BQtz8h9p.js";import"./VTable-C0gAriFq.js";import"./filter-frSNsexx.js";import"./confirm-dialog-ZAZ6P1Rc.js";const C=["name","userSet","librarySet","exclude"];Object.freeze(C);const h={name:"",userSet:[],librarySet:[],exclude:!1};Object.freeze(h);const P={name:"AdminGroupCreateUpdateInputs",components:{AdminRelationPicker:V,GroupChip:S},props:{oldRow:{type:[Object,Boolean],default:!1}},emits:["change"],data(){return{rules:{name:[t=>!!t||"Name is required",t=>!!t&&!this.names.has(t.trim())||"Name already used"]},row:{...h,...y.cloneDeep(this.oldRow)}}},computed:{...f(c,{groups:t=>t.groups,libraries:t=>t.libraries,users:t=>t.users}),names(){return this.nameSet(this.groups,"name",this.oldRow,!0)}},watch:{row:{handler(t){this.$emit("change",t)},deep:!0},oldRow:{handler(t){this.row=y.cloneDeep(t)},deep:!0}},methods:{...w(c,["nameSet"])},UPDATE_KEYS:C,EMPTY_ROW:h};function L(t,a,b,x,l,_){const p=u("GroupChip"),d=u("AdminRelationPicker");return A(),G("div",null,[s(H,{modelValue:l.row.name,"onUpdate:modelValue":a[0]||(a[0]=n=>l.row.name=n),label:"Group Name",rules:l.rules.name,clearable:"",autofocus:""},null,8,["modelValue","rules"]),s(O,{inline:"",label:"Type","model-value":l.row.exclude,"hide-details":"auto","onUpdate:modelValue":a[1]||(a[1]=n=>l.row.exclude=n)},{default:i(()=>[s(g,{value:!1},{label:i(()=>[s(p,{item:{name:"Include",exclude:!1},"title-key":"name","group-type":""})]),_:1}),s(g,{value:!0},{label:i(()=>[s(p,{item:{name:"Exclude",exclude:!0},"title-key":"name","group-type":""})]),_:1})]),_:1},8,["model-value"]),s(d,{"model-value":l.row.userSet,label:"Users",objs:t.users,"title-key":"username","onUpdate:modelValue":a[2]||(a[2]=n=>l.row.userSet=n)},null,8,["model-value","objs"]),s(d,{"model-value":l.row.librarySet,label:"Libraries",objs:t.libraries,"title-key":"path","onUpdate:modelValue":a[3]||(a[3]=n=>l.row.librarySet=n)},null,8,["model-value","objs"])])}const z=k(P,[["render",L]]),B=180,Y={name:"AdminGroupsTab",components:{AdminTable:D,AdminDeleteRowDialog:N,AdminCreateUpdateDialog:j,RelationChips:E,GroupChip:S},data(){return{lastUpdate:{pk:0,field:void 0},AdminGroupCreateUpdateInputs:T(z),GROUP_HELP_HEIGHT:B,headers:[{title:"Name",key:"name",align:"start"},{title:"Type",key:"exclude",align:"start"},{title:"Users",key:"userSet"},{title:"Libraries",key:"librarySet"},{title:"Actions",key:"actions",sortable:!1}]}},computed:{...f(c,{groups:t=>t.groups,libraries:t=>t.libraries,users:t=>t.users})},mounted(){this.loadTables(["User","Library","Group"])},methods:{...w(c,["loadTables"]),groupType(t){const a=t.exclude;return{name:a?"Exclude ":"Include",exclude:a}}}},o=t=>(I("data-v-0893032c"),t=t(),v(),t),q={class:"tabHeader"},F=o(()=>e("td",{class:"adminNoData",colspan:"100%"},"No groups",-1)),K={id:"groupHelp"},M=o(()=>e("h3",null,"Group Logic",-1)),Q=o(()=>e("p",null," A library in no groups is accessible to every user and non-users if those are enabled. ",-1)),W=o(()=>e("p",null,[m(" A library with "),e("em",null,"any"),m(" Include groups is accessible "),e("em",null,"only"),m(" to users who are in those groups. ")],-1)),J=o(()=>e("p",null,[m(" A library with "),e("em",null,"any"),m(" Exclude groups is not accessible to Guest users but is acccessable to any logged in users that are not in the Exclude groups. ")],-1)),X=o(()=>e("p",null," If you have libraries added and you do not see them in your browser, check to see if the library and your user are in the same group. ",-1)),Z={id:"groupTable"},$=o(()=>e("thead",null,[e("tr",null,[e("th",null,"Library in Group Type"),e("th",null,"Guest"),e("th",null,"User Out of Group"),e("th",null,"User In Group")])],-1)),ee=o(()=>e("tr",null,[e("td",null,"Not in a Group"),e("td",{class:"see"},"Can See"),e("td",{class:"see"},"Can See"),e("td",{class:"see"},"Can See")],-1)),te=o(()=>e("td",{class:"hidden"},"Hidden",-1)),se=o(()=>e("td",{class:"hidden"},"Hidden",-1)),oe=o(()=>e("td",{class:"see"},"Can See",-1)),le=o(()=>e("td",{class:"hidden"},"Hidden",-1)),ae=o(()=>e("td",{class:"see"},"Can See",-1)),ne=o(()=>e("td",{class:"hidden"},"Hidden",-1));function re(t,a,b,x,l,_){const p=u("AdminCreateUpdateDialog"),d=u("GroupChip"),n=u("RelationChips"),R=u("AdminDeleteRowDialog"),U=u("AdminTable");return A(),G("div",null,[e("header",q,[s(p,{table:"Group","max-width":"20em",inputs:l.AdminGroupCreateUpdateInputs},null,8,["inputs"])]),s(U,{"item-title":"name",headers:l.headers,items:t.groups},{"no-data":i(()=>[F]),"item.exclude":i(({item:r})=>[s(d,{"group-type":"",item:_.groupType(r),"title-key":"name"},null,8,["item"])]),"item.userSet":i(({item:r})=>[s(n,{pks:r.userSet,objs:t.users,"title-key":"username"},null,8,["pks","objs"])]),"item.librarySet":i(({item:r})=>[s(n,{pks:r.librarySet,objs:t.libraries,"title-key":"path"},null,8,["pks","objs"])]),"item.actions":i(({item:r})=>[s(p,{table:"Group","old-row":r,"max-width":"20em",inputs:l.AdminGroupCreateUpdateInputs,size:"small",density:"compact"},null,8,["old-row","inputs"]),s(R,{table:"Group",pk:r.pk,name:r.name,size:"small",density:"compact"},null,8,["pk","name"])]),_:2},1032,["headers","items"]),e("div",K,[M,Q,W,J,X,e("table",Z,[$,e("tbody",null,[ee,e("tr",null,[e("td",null,[s(d,{item:{name:"Include",exclude:!1},"title-key":"name","group-type":""})]),te,se,oe]),e("tr",null,[e("td",null,[s(d,{item:{name:"Exclude",exclude:!0},"title-key":"name","group-type":""})]),le,ae,ne])])])])])}const ke=k(Y,[["render",re],["__scopeId","data-v-0893032c"]]);export{ke as default};
