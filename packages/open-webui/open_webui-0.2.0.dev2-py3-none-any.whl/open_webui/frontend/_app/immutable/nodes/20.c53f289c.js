import{s as re,a as A,e as Q,M as ie,d as p,c as H,i as J,w as W,P as ne,p as R,f as y,l as Z,g as b,h as E,m as x,j as I,r as f,n as $,X as q,t as C}from"../chunks/scheduler.bc5a4ea8.js";import{S as ue,i as me,a as O,t as T,c as ce,f as G,b as fe,d as de,m as ge,e as _e,g as pe}from"../chunks/index.5e522d2c.js";import{g as ee}from"../chunks/navigation.01f37cd6.js";import{p as he}from"../chunks/stores.3eb2f079.js";import{d as se}from"../chunks/dayjs.min.b0a164f5.js";import{h as te,W as ve,e as ye,f as be}from"../chunks/index.dca233de.js";import{j as Ie}from"../chunks/index.9a95918f.js";import{r as we}from"../chunks/index.3b9fd815.js";import{M as Me}from"../chunks/Messages.fc6d27d5.js";import"../chunks/Toaster.svelte_svelte_type_style_lang.264cdd7d.js";import"../chunks/create.427b7dc2.js";import{b as Se}from"../chunks/index.d36de17a.js";/* empty css                                                       */import"../chunks/FileSaver.min.898eb36f.js";import{e as Ee}from"../chunks/index.af63e8f1.js";import"../chunks/index.c4ca6160.js";function ae(s){let u,t,r,i,a,o,m,w,v=se(s[4].chat.timestamp).format(s[10].t("MMMM DD, YYYY"))+"",k,M,D,V,S,c,n,d,Y,j,B,e;function g(l){s[14](l)}function oe(l){s[15](l)}function le(l){s[16](l)}let N={user:s[5],chatId:s[8],readOnly:!0,selectedModels:s[3],processing:De,bottomPadding:s[12].length>0,sendPrompt:Ve,continueGeneration:Ye,regenerateResponse:je};return s[0]!==void 0&&(N.history=s[0]),s[7]!==void 0&&(N.messages=s[7]),s[2]!==void 0&&(N.autoScroll=s[2]),d=new Me({props:N}),R.push(()=>G(d,"history",g)),R.push(()=>G(d,"messages",oe)),R.push(()=>G(d,"autoScroll",le)),{c(){u=y("div"),t=y("div"),r=y("div"),i=y("div"),a=y("div"),o=Z(s[6]),m=A(),w=y("div"),k=Z(v),M=A(),D=y("hr"),V=A(),S=y("div"),c=y("div"),n=y("div"),fe(d.$$.fragment),this.h()},l(l){u=b(l,"DIV",{class:!0});var _=E(u);t=b(_,"DIV",{class:!0});var h=E(t);r=b(h,"DIV",{class:!0});var P=E(r);i=b(P,"DIV",{});var U=E(i);a=b(U,"DIV",{class:!0});var X=E(a);o=x(X,s[6]),X.forEach(p),m=H(U),w=b(U,"DIV",{class:!0});var z=E(w);k=x(z,v),z.forEach(p),U.forEach(p),M=H(P),D=b(P,"HR",{class:!0}),P.forEach(p),V=H(h),S=b(h,"DIV",{class:!0,id:!0});var F=E(S);c=b(F,"DIV",{class:!0});var K=E(c);n=b(K,"DIV",{class:!0});var L=E(n);de(d.$$.fragment,L),L.forEach(p),K.forEach(p),F.forEach(p),h.forEach(p),_.forEach(p),this.h()},h(){I(a,"class","text-3xl font-semibold line-clamp-1"),I(w,"class","mt-1 text-gray-400"),I(D,"class","dark:border-gray-800 mt-6 mb-2"),I(r,"class","px-3 w-full max-w-5xl mx-auto"),I(n,"class","py-2"),I(c,"class","h-full w-full flex flex-col py-4"),I(S,"class","flex flex-col w-full flex-auto overflow-auto h-0"),I(S,"id","messages-container"),I(t,"class","flex flex-col flex-auto justify-center py-8"),I(u,"class","min-h-screen max-h-screen w-full flex flex-col text-gray-700 dark:text-gray-100 bg-white dark:bg-gray-900")},m(l,_){J(l,u,_),f(u,t),f(t,r),f(r,i),f(i,a),f(a,o),f(i,m),f(i,w),f(w,k),f(r,M),f(r,D),f(t,V),f(t,S),f(S,c),f(c,n),ge(d,n,null),e=!0},p(l,_){(!e||_&64)&&$(o,l[6]),(!e||_&1040)&&v!==(v=se(l[4].chat.timestamp).format(l[10].t("MMMM DD, YYYY"))+"")&&$(k,v);const h={};_&32&&(h.user=l[5]),_&256&&(h.chatId=l[8]),_&8&&(h.selectedModels=l[3]),!Y&&_&1&&(Y=!0,h.history=l[0],q(()=>Y=!1)),!j&&_&128&&(j=!0,h.messages=l[7],q(()=>j=!1)),!B&&_&4&&(B=!0,h.autoScroll=l[2],q(()=>B=!1)),d.$set(h)},i(l){e||(O(d.$$.fragment,l),e=!0)},o(l){T(d.$$.fragment,l),e=!1},d(l){l&&p(u),_e(d)}}}function ke(s){let u,t,r,i;document.title=u=`
		`+(s[6]?`${s[6].length>30?`${s[6].slice(0,30)}...`:s[6]} | ${s[9]}`:`${s[9]}`)+`
	`;let a=s[1]&&ae(s);return{c(){t=A(),a&&a.c(),r=Q()},l(o){ie("svelte-1123lr8",document.head).forEach(p),t=H(o),a&&a.l(o),r=Q()},m(o,m){J(o,t,m),a&&a.m(o,m),J(o,r,m),i=!0},p(o,[m]){(!i||m&576)&&u!==(u=`
		`+(o[6]?`${o[6].length>30?`${o[6].slice(0,30)}...`:o[6]} | ${o[9]}`:`${o[9]}`)+`
	`)&&(document.title=u),o[1]?a?(a.p(o,m),m&2&&O(a,1)):(a=ae(o),a.c(),O(a,1),a.m(r.parentNode,r)):a&&(pe(),T(a,1,1,()=>{a=null}),ce())},i(o){i||(O(a),i=!0)},o(o){T(a),i=!1},d(o){o&&(p(t),p(r)),a&&a.d(o)}}}let De="";const Ve=()=>{},Ye=()=>{},je=()=>{};function Be(s,u,t){let r,i,a,o;W(s,te,e=>t(8,r=e)),W(s,he,e=>t(13,i=e)),W(s,ve,e=>t(9,a=e));const m=ne("i18n");W(s,m,e=>t(10,o=e));let w=!1,v=!0,k=[""],M=null,D=null,V="",S=[],c=[],n={messages:{},currentId:null};const d=async()=>{if(await ye.set(await Se(localStorage.token)),await te.set(i.params.id),t(4,M=await we(localStorage.token,r).catch(async e=>(await ee("/"),null))),M){t(5,D=await Ee(localStorage.token,M.user_id).catch(g=>(console.error(g),null)));const e=M.chat;if(e){console.log(e),t(3,k=((e==null?void 0:e.models)??void 0)!==void 0?e.models:[e.models??""]),t(0,n=((e==null?void 0:e.history)??void 0)!==void 0?e.history:Ie(e.messages)),t(6,V=e.title);let g=JSON.parse(localStorage.getItem("settings")??"{}");return await be.set({...g,system:e.system??g.system,options:e.options??g.options}),t(2,v=!0),await C(),c.length>0&&t(0,n.messages[c.at(-1).id].done=!0,n),await C(),!0}else return null}};function Y(e){n=e,t(0,n)}function j(e){c=e,t(7,c),t(0,n)}function B(e){v=e,t(2,v)}return s.$$.update=()=>{if(s.$$.dirty&1)if(n.currentId!==null){let e=[],g=n.messages[n.currentId];for(;g!==null;)e.unshift({...g}),g=g.parentId!==null?n.messages[g.parentId]:null;t(7,c=e)}else t(7,c=[]);s.$$.dirty&8192&&i.params.id&&(async()=>await d()?(await C(),t(1,w=!0)):await ee("/"))()},[n,w,v,k,M,D,V,c,r,a,o,m,S,i,Y,j,B]}class Ke extends ue{constructor(u){super(),me(this,u,Be,ke,re,{})}}export{Ke as component};
//# sourceMappingURL=20.c53f289c.js.map
