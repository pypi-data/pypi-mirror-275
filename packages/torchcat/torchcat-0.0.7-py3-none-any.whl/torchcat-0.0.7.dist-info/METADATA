Metadata-Version: 2.1
Name: torchcat
Version: 0.0.7
Summary: This is a test of the setup
Home-page: https://gitee.com/kkkaiyu/torchcat
Author: KaiYu
Author-email: 2971934557@qq.com
License: GPL-3.0
Requires-Python: >=3.9
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: numpy
Requires-Dist: torchsummary

# TorchCat ğŸ±

# ç®€ä»‹

TorchCat æ˜¯ç”¨äºå°è£… PyTorch æ¨¡å‹çš„å·¥å…·

æä¾›ä»¥ä¸‹åŠŸèƒ½ï¼š

- ç®€åŒ–è®­ç»ƒè¿‡ç¨‹
- ç®€åŒ–æµ‹è¯•è¿‡ç¨‹
- è®°å½•è®­ç»ƒæ—¥å¿—

# ç”¨æ³•

å¯¼å…¥ TorchCat

```python
import torchcat
```

## å°è£…æ¨¡å‹

ä½¿ç”¨ `Cat` å°è£…ä½ çš„æ¨¡å‹ã€‚å¦‚æœä¸è¿›è¡Œè®­ç»ƒï¼Œä¹Ÿå¯ä»¥å¿½ç•¥ `loss_fn`ã€`torchcat` å‚æ•°

```python
net = nn.Sequential(
    nn.Flatten(),
    nn.Linear(28*28, 128),
    nn.ReLU(),
    nn.Linear(128, 10),
)

net = torchcat.Cat(model=net,
                   loss_fn=nn.CrossEntropyLoss(),
                   optimizer=torch.optim.Adam(net.parameters(), lr=0.0003))
```

| å‚æ•°      | è¯´æ˜     |
| --------- | -------- |
| model     | ä½ çš„æ¨¡å‹ |
| loss_fn   | æŸå¤±å‡½æ•° |
| optimizer | ä¼˜åŒ–å™¨   |

## æŸ¥çœ‹æ¶æ„

åœ¨å°è£…æ¨¡å‹åï¼Œä½¿ç”¨ **net.summary()**ï¼Œå¯ä»¥æŸ¥çœ‹æ¨¡å‹çš„æ¶æ„ã€‚**input_size** å‚æ•°éœ€å¡«å†™æ¨¡å‹çš„è¾“å…¥å½¢çŠ¶ï¼Œå¦‚ï¼š`net.summary(1, 28, 28)`

## è®­ç»ƒæ¨¡å‹

ä½¿ç”¨ `net.train()`ï¼Œå¯ä»¥å¼€å§‹æ¨¡å‹çš„è®­ç»ƒã€‚è®­ç»ƒç»“æŸåä¼šè¿”å›è®­ç»ƒæ—¥å¿—

```python
log = net.train(train_set=train_set, epochs=5, valid_set=test_set)
```

`log` è®°å½•äº†è®­ç»ƒæ—¶çš„æ—¥å¿—ï¼ŒåŒ…æ‹¬ä»¥ä¸‹å†…å®¹

* è®­ç»ƒé›†æŸå¤±ï¼ˆ**log['train** **loss']**ï¼‰
* è®­ç»ƒé›†å‡†ç¡®ç‡ï¼ˆ**log['train** **acc']**ï¼‰
* éªŒè¯é›†æŸå¤±ï¼ˆ**log['valid** **loss']**ï¼‰
* éªŒè¯é›†å‡†ç¡®ç‡ï¼ˆ**log['validacc']**ï¼‰

| å‚æ•°      | è¯´æ˜                |
| --------- | ------------------- |
| train_set | è®­ç»ƒé›†              |
| epochs    | è®­ç»ƒè½®æ¬¡            |
| valid_set | éªŒè¯é›†ï¼ˆé»˜è®¤ Noneï¼‰ |

## éªŒè¯æ¨¡å‹

ä½¿ç”¨ `net.valid(valid_set, show=True, train=False)`ï¼Œèƒ½å¤ŸéªŒè¯æ¨¡å‹

| å‚æ•°      | è¯´æ˜                                           |
| --------- | ---------------------------------------------- |
| valid_set | éªŒè¯é›†                                         |
| show      | æ˜¯å¦è¾“å‡ºéªŒè¯é›†æŸå¤±å€¼ã€å‡†ç¡®ç‡ï¼ˆé»˜è®¤ Trueï¼‰      |
| train     | éªŒè¯åï¼Œæ¨¡å‹æ˜¯å¦ä¸”åˆ‡æ¢ä¸ºè®­ç»ƒæ¨¡å¼ï¼ˆé»˜è®¤ Falseï¼‰ |

# å…¶ä»–

## åˆ‡æ¢è®¡ç®—è®¾å¤‡

TorchCat æä¾›äº†æ–¹æ³• `to_cpu()`ã€`to_cuda()` ç”¨äºåˆ‡æ¢è®¡ç®—è®¾å¤‡ï¼ˆCPU æˆ– GPUğŸš€ï¼‰

## æ£€æŸ¥æ¨¡å‹å½“å‰æ¨¡å¼

ä½¿ç”¨ `training` æ–¹æ³•ï¼Œæ¨¡å‹å½“å‰æ˜¯å¦å¤„äºè®­ç»ƒæ¨¡å¼ã€‚è¿”å› `True` è¡¨ç¤ºå¤„äºè®­ç»ƒæ¨¡å¼ï¼Œ`False` è¡¨ç¤ºå¤„äºæ¨ç†æ¨¡å¼

## æ¨¡å‹æ¨ç†

* æ–¹æ³•åï¼š`__call__`
* åŠŸèƒ½æè¿°ï¼šæ‰§è¡Œæ¨¡å‹çš„å‰å‘æ¨ç†è¿‡ç¨‹
* å‚æ•°ï¼š`x` - è¾“å…¥æ•°æ®
* è¿”å›å€¼ï¼šæ¨¡å‹å¯¹è¾“å…¥æ•°æ® `x` çš„æ¨ç†ç»“æœ
