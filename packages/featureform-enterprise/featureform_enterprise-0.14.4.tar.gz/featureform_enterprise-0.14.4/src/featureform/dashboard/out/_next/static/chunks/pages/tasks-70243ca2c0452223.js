(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3689],{1849:function(t,e,n){"use strict";var i=n(64836);e.Z=void 0;var a=i(n(64938)),l=n(85893),r=(0,a.default)((0,l.jsx)("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"}),"Refresh");e.Z=r},42761:function(t,e,n){"use strict";var i=n(64836);e.Z=void 0;var a=i(n(64938)),l=n(85893),r=(0,a.default)((0,l.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"}),"Search");e.Z=r},56670:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/tasks",function(){return n(16854)}])},16854:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return D}});var i=n(85893),a=n(67294),l=n(47568),r=n(26042),o=n(69396),s=n(10092),u=n(1849),d=n(42761),c=n(87357),v=n(69397),h=n(23972),f=n(16003),x=n(53640),m=n(60076),g=n(69587),b=n(63931),k=n(22715),j=n(91057),p=n(54799),Z=n(21023),R=n(66489),w=n(310),C=(0,n(45522).Z)(function(){return{inputRow:{paddingBottom:10,"& button":{height:40}},activeButton:{color:"#000000",fontWeight:"bold"},activeChip:{color:"#FFFFFF",background:"#7A14E5",height:20,width:45,fontSize:11},inactiveChip:{color:"#FFFFFF",background:"#BFBFBF",height:20,width:45,fontSize:11},inactiveButton:{color:"#000000",background:"#FFFFFF"},buttonText:{textTransform:"none",paddingRight:10},filterInput:{minWidth:225,height:40},taskCardBox:{height:750,width:700}}}),I=n(90103),N=n(92814);function T(t){var e,n,a=t.status;return(0,i.jsx)(f.Z,{sx:{backgroundColor:null!==(e=({3:"#D1FAD0",2:"#FAECD0",1:"#FAECD0",4:"#FAD0F6",5:"#D6D0FA"})[a])&&void 0!==e?e:"#FFFFFF"},size:"small",label:null!==(n=({0:"No Status",1:"Created",2:"Pending",3:"Ready",4:"Failed",5:"Running"})[a])&&void 0!==n?n:"No Status"})}var S=n(50594),F=n(48263);function y(t){var e,n,r,o,d,v=t.handleClose,f=t.taskId,x=t.taskRunId,m=C(),g=(0,w.E)(),b=(0,a.useState)({}),j=b[0],I=b[1],y=(0,a.useState)(!0),E=y[0],A=y[1];(0,a.useEffect)((0,l.Z)(function(){var t,e,n;return(0,s.__generator)(this,function(e){switch(e.label){case 0:if(t=null,!(f&&x&&E))return[3,2];return[4,g.getTaskRunDetails(f,x)];case 1:return I(e.sent()),n=setTimeout(function(){A(!1)},750),[2,function(){n&&clearTimeout(n)}];case 2:return[2,function(){t&&clearTimeout(t)}]}})}),[f,x,E]);var L=function(){E||A(!0)};return(0,i.jsxs)(c.Z,{className:m.taskCardBox,children:[(0,i.jsxs)(c.Z,{style:{float:"right"},children:[(0,i.jsx)(Z.Z,{title:"Refresh card",placement:"bottom",children:(0,i.jsx)(p.Z,{variant:"",size:"large",onClick:L,children:E?(0,i.jsx)(R.Z,{size:".75em"}):(0,i.jsx)(u.Z,{"data-testid":"taskRunRefreshIcon"})})}),(0,i.jsx)(p.Z,{variant:"",size:"large",onClick:function(){return v()},children:(0,i.jsx)(S.Z,{})})]}),(0,i.jsxs)(F.ZP,{style:{padding:10},container:!0,children:[(0,i.jsx)(F.ZP,{item:!0,xs:7,justifyContent:"flex-start",children:(0,i.jsx)(h.Z,{variant:"h5",children:null!==(r=null==j?void 0:null===(e=j.taskRun)||void 0===e?void 0:e.name)&&void 0!==r?r:""})}),(0,i.jsx)(F.ZP,{item:!0,xs:4,justifyContent:"center",children:(0,i.jsxs)(h.Z,{variant:"h6",children:[(0,i.jsx)("strong",{children:"Status:"})," ",(0,i.jsx)(T,{status:null!==(o=null==j?void 0:null===(n=j.taskRun)||void 0===n?void 0:n.status)&&void 0!==o?o:""})]})}),(0,i.jsx)(F.ZP,{item:!0,xs:12,justifyContent:"flex-start",style:{paddingTop:20},children:(0,i.jsx)(h.Z,{variant:"h6",children:"Logs/Errors"})}),(0,i.jsx)(F.ZP,{item:!0,xs:12,justifyContent:"flex-start",children:(0,i.jsx)(k.Z,{style:{width:"100%"},variant:"filled",disabled:!0,value:function(){var t,e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i="";return(null==n?void 0:null===(t=n.taskRun)||void 0===t?void 0:t.logs)&&(i+=n.taskRun.logs.join("\n")),(null==n?void 0:null===(e=n.taskRun)||void 0===e?void 0:e.error)&&(i+="\n"+n.taskRun.error),i}(j),multiline:!0,minRows:3})}),(0,i.jsx)(F.ZP,{item:!0,xs:12,justifyContent:"flex-start",style:{paddingTop:20},children:(0,i.jsx)(h.Z,{variant:"h6",children:"Other Runs"})}),(0,i.jsx)(F.ZP,{item:!0,xs:12,justifyContent:"flex-start"}),(0,i.jsx)(F.ZP,{item:!0,xs:12,justifyContent:"center",children:(0,i.jsx)(N._,{density:"compact",autoHeight:!0,"aria-label":"Other Runs",sx:{"& .MuiDataGrid-cell:focus":{outline:"none"},"& .MuiDataGrid-columnHeaderTitle":{fontWeight:"bold"}},rows:null!==(d=null==j?void 0:j.otherRuns)&&void 0!==d?d:[],disableColumnMenu:!0,rowsPerPageOptions:[5],columns:[{field:"runId",headerName:"runId",width:1,editable:!1,sortable:!1,filterable:!1,hide:!0,hideable:!1,display:!1},{field:"startTime",headerName:"Start Time",sortable:!1,filterable:!1,width:200,valueGetter:function(t){var e,n;return(n=new Date(null==t?void 0:null===(e=t.row)||void 0===e?void 0:e.startTime)).toLocaleString()}},{field:"status",headerName:"Status",width:200,align:"right",editable:!1,sortable:!1,filterable:!1,renderCell:function(t){var e;return(0,i.jsx)(T,{status:null==t?void 0:null===(e=t.row)||void 0===e?void 0:e.status})}},{field:"link",headerName:"Link",width:250,editable:!1,sortable:!1,filterable:!1,valueGetter:function(){return"Future Link"}},],initialState:{pagination:{paginationModel:{page:0,pageSize:5}}},pageSize:5,getRowId:function(t){return t.runId}})})]})]})}function E(t){var e=t.taskRunList,n=void 0===e?[]:e,l=function(){s(!1)},r=(0,a.useState)(!1),o=r[0],s=r[1],u=(0,a.useState)({taskRun:{taskId:0,runId:0}}),d=u[0],c=u[1],v={0:"Resource Creation",1:"Health Check",2:"Metrics"},h=function(t){var e=null==n?void 0:n.find(function(e){return e.taskRun.taskId===t.row.taskRun.taskId&&e.taskRun.runId===t.row.taskRun.runId});c(null!=e?e:{taskRun:{taskId:0,runId:0}}),s(function(e){return d!==t.row.id||!e})},f=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return t>10?15:t>5?10:5}(null==n?void 0:n.length);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(I.ZP,{open:o,anchorReference:"anchorPosition",anchorPosition:{top:250,left:Number.MAX_SAFE_INTEGER},onClose:l,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:(0,i.jsx)(y,{handleClose:l,taskId:d.taskRun.taskId,taskRunId:d.taskRun.runId})}),(0,i.jsx)(N._,{autoHeight:!0,sx:{minWidth:300,"& .MuiDataGrid-cell:focus":{outline:"none"},"& .MuiDataGrid-row:hover":{cursor:"pointer"},"& .MuiDataGrid-columnHeaderTitle":{fontWeight:"bold"}},onRowClick:h,rowsPerPageOptions:[5,10,15],disableColumnMenu:!0,density:"compact","aria-label":"Task Runs",rows:null!=n?n:[],columns:[{field:"id",headerName:"Id",flex:1,width:100,editable:!1,sortable:!1,filterable:!1,hide:!0},{field:"taskId",headerName:"Task Id",flex:1,width:50,editable:!1,sortable:!1,filterable:!1,hide:!1,valueGetter:function(t){var e,n;return null==t?void 0:null===(e=t.row)||void 0===e?void 0:null===(n=e.taskRun)||void 0===n?void 0:n.taskId}},{field:"runId",headerName:"Run Id",flex:1,width:50,editable:!1,sortable:!1,filterable:!1,hide:!1,valueGetter:function(t){var e,n;return null==t?void 0:null===(e=t.row)||void 0===e?void 0:null===(n=e.taskRun)||void 0===n?void 0:n.runId}},{field:"name",headerName:"Task Name",flex:1,minWidth:250,editable:!1,sortable:!1,filterable:!1,valueGetter:function(t){var e,n;return null==t?void 0:null===(e=t.row)||void 0===e?void 0:null===(n=e.taskRun)||void 0===n?void 0:n.name}},{field:"resource",headerName:"Resource",flex:1,minWidth:150,editable:!1,sortable:!1,filterable:!1,valueGetter:function(t){var e,n,i;return null==t?void 0:null===(e=t.row)||void 0===e?void 0:null===(n=e.task)||void 0===n?void 0:null===(i=n.target)||void 0===i?void 0:i.name}},{field:"variant",headerName:"Variant",flex:1,minWidth:175,editable:!1,sortable:!1,filterable:!1,valueGetter:function(t){var e,n,i;return null==t?void 0:null===(e=t.row)||void 0===e?void 0:null===(n=e.task)||void 0===n?void 0:null===(i=n.target)||void 0===i?void 0:i.variant}},{field:"jobType",headerName:"Task Type",flex:1,minWidth:150,editable:!1,sortable:!1,filterable:!1,valueGetter:function(t){var e,n,i;return null!==(i=v[null==t?void 0:null===(e=t.row)||void 0===e?void 0:null===(n=e.task)||void 0===n?void 0:n.type])&&void 0!==i?i:""}},{field:"status",headerName:"Status",flex:1,minWidth:75,editable:!1,sortable:!1,filterable:!1,valueGetter:function(t){var e,n;return null==t?void 0:null===(e=t.row)||void 0===e?void 0:null===(n=e.taskRun)||void 0===n?void 0:n.status},renderCell:function(t){var e,n;return(0,i.jsx)(T,{status:null==t?void 0:null===(e=t.row)||void 0===e?void 0:null===(n=e.taskRun)||void 0===n?void 0:n.status})}},{field:"startTime",headerName:"Start Time",flex:1,sortable:!1,filterable:!1,minWidth:175,valueGetter:function(t){var e,n,i;return(i=new Date(null==t?void 0:null===(e=t.row)||void 0===e?void 0:null===(n=e.taskRun)||void 0===n?void 0:n.startTime)).toLocaleString()}},{field:"endTime",headerName:"End Time",flex:1,sortable:!1,filterable:!1,minWidth:175,valueGetter:function(t){var e,n,i;return(i=new Date(null==t?void 0:null===(e=t.row)||void 0===e?void 0:null===(n=e.taskRun)||void 0===n?void 0:n.endTime)).toLocaleString()}},{field:"triggeredBy",headerName:"Triggered By",flex:1,width:125,editable:!1,valueGetter:function(t){var e,n,i;return null==t?void 0:null===(e=t.row)||void 0===e?void 0:null===(n=e.taskRun)||void 0===n?void 0:null===(i=n.trigger)||void 0===i?void 0:i.triggerName}},],initialState:{pagination:{paginationModel:{page:1,pageSize:f}}},pageSize:f,getRowId:function(t){return t.id}})]})}function A(){var t=C(),e=(0,w.E)(),n="ACTIVE",I="COMPLETE",N="STATUS_DATE",T={NO_STATUS:0,CREATED:1,PENDING:2,READY:3,FAILED:4,RUNNING:5},S={status:"ALL",sortBy:N,searchText:""},F=(0,a.useState)((0,r.Z)({},S)),y=F[0],A=F[1],L=(0,a.useState)(""),D=L[0],P=L[1],B=(0,a.useState)([]),G=B[0],_=B[1],z=(0,a.useState)(!0),M=z[0],W=z[1],O=(0,a.useState)(0),H=O[0],U=O[1],V=(0,a.useState)(0),X=V[0],Y=V[1],K=(0,a.useState)(0),q=K[0],J=K[1];(0,a.useEffect)((0,l.Z)(function(){var t,n,i,a,l,r;return(0,s.__generator)(this,function(o){switch(o.label){case 0:if(!M)return[3,2];return[4,e.getTaskRuns(y)];case 1:return t=o.sent(),y.searchText||y.sortBy!=N||"ALL"!=y.status||((null==t?void 0:t.length)?(U(t.length),Y(null!==(a=null===(n=t.filter(function(t){var e;return[T.PENDING,T.RUNNING].includes(null==t?void 0:null===(e=t.taskRun)||void 0===e?void 0:e.status)}))||void 0===n?void 0:n.length)&&void 0!==a?a:0),J(null!==(l=null===(i=t.filter(function(t){var e;return[T.FAILED,T.READY].includes(null==t?void 0:null===(e=t.taskRun)||void 0===e?void 0:e.status)}))||void 0===i?void 0:i.length)&&void 0!==l?l:0)):(U(0),Y(0),J(0))),_(t),r=setTimeout(function(){W(!1)},750),[2,function(){r&&clearTimeout(r)}];case 2:return[2]}})}),[y,M]);var Q=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ALL";A((0,o.Z)((0,r.Z)({},y),{status:t})),W(!0)},$=function(t){var e,n,i=null!==(n=null==t?void 0:null===(e=t.target)||void 0===e?void 0:e.value)&&void 0!==n?n:"";A((0,o.Z)((0,r.Z)({},y),{sortBy:i})),W(!0)},tt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";A((0,o.Z)((0,r.Z)({},y),{searchText:t})),W(!0)},te=function(){M||W(!0)},tn=function(){A((0,r.Z)({},S)),P(""),W(!0)};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(c.Z,{className:t.inputRow,children:[(0,i.jsxs)(v.Z,{variant:"text",className:"ALL"===y.status?t.activeButton:t.inactiveButton,onClick:function(){return Q("ALL")},children:[(0,i.jsx)(h.Z,{variant:"button",className:t.buttonText,children:"All"}),(0,i.jsx)(f.Z,{label:H,"data-testid":"allId",className:"ALL"===y.status?t.activeChip:t.inactiveChip})]}),(0,i.jsxs)(v.Z,{variant:"text",className:y.status===n?t.activeButton:t.inactiveButton,onClick:function(){return Q(n)},children:[(0,i.jsx)(h.Z,{variant:"button",className:t.buttonText,children:"Active"}),(0,i.jsx)(f.Z,{label:X,"data-testid":"activeId",className:y.status===n?t.activeChip:t.inactiveChip})]}),(0,i.jsxs)(v.Z,{variant:"text",className:y.status===I?t.activeButton:t.inactiveButton,onClick:function(){return Q(I)},children:[(0,i.jsx)(h.Z,{variant:"button",className:t.buttonText,children:"Complete"}),(0,i.jsx)(f.Z,{label:q,"data-testid":"completeId",className:y.status===I?t.activeChip:t.inactiveChip})]}),(0,i.jsxs)(c.Z,{style:{float:"right"},children:[(0,i.jsxs)(x.Z,{style:{paddingRight:"15px"},children:[(0,i.jsx)(m.Z,{shrink:!0,id:"sortId",children:"Sort By"}),(0,i.jsxs)(g.Z,{value:y.sortBy,onChange:$,label:"Sort By",notched:!0,className:t.filterInput,children:[(0,i.jsx)(b.Z,{value:"STATUS",children:"Status"}),(0,i.jsx)(b.Z,{value:N,children:"Date"})]})]}),(0,i.jsx)(x.Z,{children:(0,i.jsx)(k.Z,{size:"small",InputLabelProps:{shrink:!0},label:"Search",onChange:function(t){var e,n=t.target.value;if(""===n){P(n),tt("");return}var i=null!==(e=t.target.value)&&void 0!==e?e:"";i.trim()&&P(i)},value:D,onKeyDown:function(t){"Enter"===t.key&&D&&tt(D)},InputProps:{endAdornment:(0,i.jsx)(j.Z,{position:"end",children:(0,i.jsx)(p.Z,{children:(0,i.jsx)(d.Z,{})})})},inputProps:{"aria-label":"search","data-testid":"searcInputId"}})}),(0,i.jsx)(Z.Z,{title:"Refresh table",placement:"top",children:(0,i.jsx)(p.Z,{size:"large",onClick:te,children:M?(0,i.jsx)(R.Z,{size:".85em","data-testid":"circularProgressId"}):(0,i.jsx)(u.Z,{"data-testid":"refreshIcon"})})}),(0,i.jsx)(Z.Z,{title:"Clear filter inputs",placement:"top",children:(0,i.jsx)(p.Z,{size:"large",onClick:tn,children:(0,i.jsx)("img",{alt:"CLEAR","data-testid":"clearIcon",src:"/static/clearIcon.svg"})})})]})]}),(0,i.jsx)(E,{taskRunList:null==G?void 0:G.map(function(t){return(0,o.Z)((0,r.Z)({},t),{id:t.taskRun.taskId+"."+t.taskRun.runId})})})]})}function L(){return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("h3",{children:"Task Runs"}),(0,i.jsx)(A,{})]})}var D=function(){return(0,i.jsx)(L,{})}}},function(t){t.O(0,[9774,2888,179],function(){return t(t.s=56670)}),_N_E=t.O()}]);