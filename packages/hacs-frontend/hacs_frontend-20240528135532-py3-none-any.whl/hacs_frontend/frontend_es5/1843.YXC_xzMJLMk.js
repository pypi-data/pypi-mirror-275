"use strict";(self.webpackChunkhacs_frontend=self.webpackChunkhacs_frontend||[]).push([[1843],{77222:function(t,e,r){function n(t){var e=t.language||"en";return t.translationMetadata.translations[e]&&t.translationMetadata.translations[e].isRTL||!1}function i(t){return o(n(t))}function o(t){return t?"rtl":"ltr"}r.d(e,{Vc:function(){return i},qC:function(){return n}})},66494:function(t,e,r){var n,i=r(6238),o=r(36683),a=r(89231),s=r(29864),c=r(83647),l=r(8364),u=(r(77052),r(58068)),h=r(5546),d=r(196),p=r(75538);(0,l.A)([(0,d.EM)("ha-button")],(function(t,e){var r=function(e){function r(){var e;(0,a.A)(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=(0,s.A)(this,r,[].concat(i)),t(e),e}return(0,c.A)(r,e),(0,o.A)(r)}(e);return{F:r,d:[{kind:"field",static:!0,key:"styles",value:function(){return[p.R,(0,h.AH)(n||(n=(0,i.A)(["::slotted([slot=icon]){margin-inline-start:0px;margin-inline-end:8px;direction:var(--direction);display:block}.mdc-button{height:var(--button-height,36px)}.trailing-icon{display:flex}.slot-container{overflow:var(--button-slot-container-overflow,visible)}"])))]}}]}}),u.$)},75475:function(t,e,r){r.r(e),r.d(e,{HacsDonwloadDialog:function(){return O}});var n=r(6238),i=r(94881),o=r(1781),a=r(36683),s=r(89231),c=r(29864),l=r(83647),u=r(8364),h=(r(77052),r(53501),r(848),r(58068),r(8774),r(5546)),d=r(196),p=r(45081),f=r(33167),_=r(46531),v=r(77222),g=(r(91074),r(66494),r(88762),r(93259),r(31447)),m=r(13136),y=r(51285),k=r(93902),w=r(23240),b=(r(4187),r(36724),r(68113),r(26777),r(34517),r(73842),r(66274),r(85767),r(98168),r(9340)),A=r(99232);function x(t,e,r){return P.apply(this,arguments)}function P(){return P=(0,o.A)((0,i.A)().mark((function t(e,r,n){var o,a,s,c,l;return(0,i.A)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=new A.M("updateLovelaceResources"),t.next=3,(0,b.kZ)(e.connection);case 3:if(a=t.sent,s="/hacsfiles/".concat(r.full_name.split("/")[1]),c=S({repository:r,version:n}),l=a.find((function(t){return t.url.includes(s)})),o.debug({namespace:s,url:c,exsisting:l}),!l||l.url===c){t.next=14;break}return o.debug("Updating exsusting resource for ".concat(s)),t.next=12,(0,b.Uh)(e,l.id,{url:c,res_type:l.type});case 12:t.next=18;break;case 14:if(a.map((function(t){return t.url})).includes(c)){t.next=18;break}return o.debug("Adding ".concat(c," to Lovelace resources")),t.next=18,(0,b.Zg)(e,{url:c,res_type:"module"});case 18:case"end":return t.stop()}}),t)}))),P.apply(this,arguments)}var z,q,C,R,M,L,E,T,D,I,S=function(t){return"/hacsfiles/".concat(t.repository.full_name.split("/")[1],"/").concat(t.repository.file_name).concat(t.skipTag?"":"?hacstag=".concat(function(t,e){return String("".concat(t.id).concat((e||t.installed_version||t.selected_tag||t.available_version).replace(/\D+/g,"")))}(t.repository,t.version)))},V=r(76646),O=(0,u.A)([(0,d.EM)("hacs-download-dialog")],(function(t,e){var r,u,b,A,P=function(e){function r(){var e;(0,s.A)(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=(0,c.A)(this,r,[].concat(i)),t(e),e}return(0,l.A)(r,e),(0,a.A)(r)}(e);return{F:P,d:[{kind:"field",decorators:[(0,d.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,d.wk)()],key:"_waiting",value:function(){return!0}},{kind:"field",decorators:[(0,d.wk)()],key:"_installing",value:function(){return!1}},{kind:"field",decorators:[(0,d.wk)()],key:"_error",value:void 0},{kind:"field",decorators:[(0,d.wk)()],key:"_repository",value:void 0},{kind:"field",decorators:[(0,d.wk)()],key:"_dialogParams",value:void 0},{kind:"field",decorators:[(0,d.wk)()],key:"_selectedVersion",value:void 0},{kind:"method",key:"showDialog",value:(A=(0,o.A)((0,i.A)().mark((function t(e){var r=this;return(0,i.A)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._dialogParams=e,this._waiting=!1,!e.repository){t.next=6;break}this._repository=e.repository,t.next=8;break;case 6:return t.next=8,this._fetchRepository();case 8:return this._repository&&"commit"!==this._repository.version_or_commit&&(this._selectedVersion=this._repository.available_version),(0,k.zl)(this.hass,(function(t){r._error=t,r._installing=!1}),m.a.ERROR),t.next=12,this.updateComplete;case 12:case"end":return t.stop()}}),t,this)}))),function(t){return A.apply(this,arguments)})},{kind:"method",key:"closeDialog",value:function(){this._dialogParams=void 0,this._repository=void 0,this._error=void 0,this._installing=!1,this._waiting=!1,(0,f.r)(this,"dialog-closed",{dialog:this.localName})}},{kind:"field",key:"_getInstallPath",value:function(){return(0,p.A)((function(t){var e=t.local_path;return["template","theme","python_script"].includes(t.category)&&(e="".concat(e,"/").concat(t.file_name)),e}))}},{kind:"method",key:"_fetchRepository",value:(b=(0,o.A)((0,i.A)().mark((function t(){return(0,i.A)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,y.vA)(this.hass,this._dialogParams.repositoryId);case 2:this._repository=t.sent;case 3:case"end":return t.stop()}}),t,this)}))),function(){return b.apply(this,arguments)})},{kind:"method",key:"render",value:function(){var t,e=this;if(!this._dialogParams||!this._repository)return h.s6;var r=this._getInstallPath(this._repository),i=[{name:"beta",selector:{boolean:{}}},{name:"version",selector:{select:{options:this._repository.releases.concat("hacs/integration"===this._repository.full_name||this._repository.hide_default_branch?[]:[this._repository.default_branch]),mode:"dropdown"}}}];return(0,h.qy)(z||(z=(0,n.A)([' <ha-dialog open scrimClickAction escapeKeyAction .heading="','" @closed="','"> <div class="content"> '," ",' <div class="note"> '," "," "," </div> "," ",' </div> <mwc-button slot="secondaryAction" @click="','" dialogInitialFocus> ',' </mwc-button> <mwc-button slot="primaryAction" ?disabled="','" @click="','"> '," </mwc-button> </ha-dialog> "])),this._repository.name,this.closeDialog,"version"===this._repository.version_or_commit&&this._repository.installed?(0,h.qy)(q||(q=(0,n.A)([' <ha-form .disabled="','" .data="','" .schema="','" .computeLabel="','" @value-changed="','"> </ha-form> <ha-alert alert-type="info" .rtl="','"> ',' <a class="learn_more" href="','" slot="action" target="_blank" rel="noreferrer"> ',"</a> </ha-alert> "])),this._waiting,"version"===this._repository.version_or_commit?{beta:this._repository.beta,version:this._selectedVersion}:{},i,(function(t){return"beta"===t.name?e._dialogParams.hacs.localize("dialog_download.show_beta"):e._dialogParams.hacs.localize("dialog_download.select_version")}),this._valueChanged,(0,v.qC)(this.hass),this._dialogParams.hacs.localize("dialog_download.selector_note"),(0,V.o)({path:"/docs/use/entities/update/#install-service"}),this._dialogParams.hacs.localize("common.learn_more")):h.s6,this._repository.can_download?"":(0,h.qy)(C||(C=(0,n.A)(['<ha-alert alert-type="error" .rtl="','"> '," </ha-alert>"])),(0,v.qC)(this.hass),this._dialogParams.hacs.localize("confirm.home_assistant_version_not_correct",{haversion:this.hass.config.version,minversion:this._repository.homeassistant})),this._dialogParams.hacs.localize("dialog_download.note_downloaded",{location:(0,h.qy)(R||(R=(0,n.A)(["<code>'","'</code>"])),r)}),"plugin"===this._repository.category&&"storage"!==this._dialogParams.hacs.info.lovelace_mode?(0,h.qy)(M||(M=(0,n.A)([" <p>","</p> <pre>\n                url: ","\n                type: module\n                </pre> "])),this._dialogParams.hacs.localize("dialog_download.lovelace_instruction"),S({repository:this._repository,skipTag:!0})):h.s6,"integration"===this._repository.category?(0,h.qy)(L||(L=(0,n.A)(["<p>","</p>"])),this._dialogParams.hacs.localize("dialog_download.restart")):h.s6,null!==(t=this._error)&&void 0!==t&&t.message?(0,h.qy)(E||(E=(0,n.A)(['<ha-alert alert-type="error" .rtl="','"> '," </ha-alert>"])),(0,v.qC)(this.hass),this._error.message):h.s6,this._installing?(0,h.qy)(T||(T=(0,n.A)(["<mwc-linear-progress indeterminate></mwc-linear-progress>"]))):h.s6,this.closeDialog,this._dialogParams.hacs.localize("common.cancel"),!this._repository.can_download||this._waiting||this._installing,this._installRepository,this._dialogParams.hacs.localize("common.download"))}},{kind:"method",key:"_valueChanged",value:(u=(0,o.A)((0,i.A)().mark((function t(e){var r;return(0,i.A)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=!1,this._repository.beta===e.detail.value.beta){t.next=6;break}return r=!0,this._waiting=!0,t.next=6,(0,k.rE)(this.hass,this._dialogParams.repositoryId,e.detail.value.beta);case 6:if(!e.detail.value.version){t.next=12;break}return r=!0,this._waiting=!0,t.next=11,(0,y.J2)(this.hass,this._dialogParams.repositoryId,e.detail.value.version);case 11:this._selectedVersion=e.detail.value.version;case 12:if(!r){t.next=16;break}return t.next=15,this._fetchRepository();case 15:this._waiting=!1;case 16:case"end":return t.stop()}}),t,this)}))),function(t){return u.apply(this,arguments)})},{kind:"method",key:"_installRepository",value:(r=(0,o.A)((0,i.A)().mark((function t(){var e,r;return(0,i.A)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._repository){t.next=2;break}return t.abrupt("return");case 2:if(!this._waiting){t.next=5;break}return this._error="Waiting to update repository information, try later.",t.abrupt("return");case 5:if(!this._installing){t.next=8;break}return this._error="Already installing, please wait.",t.abrupt("return");case 8:if(this._repository.can_download){t.next=11;break}return this._error="Can not download this repository.",t.abrupt("return");case 11:return this._installing=!0,this._error=void 0,e=this._repository.selected_tag||this._repository.available_version||this._repository.default_branch,t.prev=14,t.next=17,(0,y.l1)(this.hass,String(this._repository.id),"commit"!==(null===(r=this._repository)||void 0===r?void 0:r.version_or_commit)?this._selectedVersion:void 0);case 17:t.next=24;break;case 19:return t.prev=19,t.t0=t.catch(14),this._error=t.t0||{message:"Could not download repository, check core logs for more information."},this._installing=!1,t.abrupt("return");case 24:if(this._dialogParams.hacs.log.debug(this._repository.category,"_installRepository"),this._dialogParams.hacs.log.debug(this._dialogParams.hacs.info.lovelace_mode,"_installRepository"),"plugin"!==this._repository.category||"storage"!==this._dialogParams.hacs.info.lovelace_mode){t.next=29;break}return t.next=29,x(this.hass,this._repository,e);case 29:this._installing=!1,"plugin"===this._repository.category&&(0,g.dk)(this,{title:this._dialogParams.hacs.localize("common.reload"),text:(0,h.qy)(D||(D=(0,n.A)(["","<br>",""])),this._dialogParams.hacs.localize("dialog.reload.description"),this._dialogParams.hacs.localize("dialog.reload.confirm")),dismissText:this._dialogParams.hacs.localize("common.cancel"),confirmText:this._dialogParams.hacs.localize("common.reload"),confirm:function(){_.G.location.href=_.G.location.href}}),void 0===this._error&&this.closeDialog();case 32:case"end":return t.stop()}}),t,this,[[14,19]])}))),function(){return r.apply(this,arguments)})},{kind:"get",static:!0,key:"styles",value:function(){return[w.k,(0,h.AH)(I||(I=(0,n.A)([".note{margin-top:12px}.lovelace{margin-top:8px}.learn_more{color:var(--hcv-text-color-primary)}pre{white-space:pre-line;user-select:all}mwc-linear-progress{margin-bottom:-8px;margin-top:4px}"])))]}}]}}),h.WF)},51285:function(t,e,r){r.d(e,{J2:function(){return s},l1:function(){return a},vA:function(){return o}});var n=r(94881),i=r(1781),o=function(){var t=(0,i.A)((0,n.A)().mark((function t(e,r){return(0,n.A)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.connection.sendMessagePromise({type:"hacs/repository/info",repository_id:r}));case 1:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),a=function(){var t=(0,i.A)((0,n.A)().mark((function t(e,r,i){return(0,n.A)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.connection.sendMessagePromise({type:"hacs/repository/download",repository:r,version:i}));case 1:case"end":return t.stop()}}),t)})));return function(e,r,n){return t.apply(this,arguments)}}(),s=function(){var t=(0,i.A)((0,n.A)().mark((function t(e,r,i){return(0,n.A)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.connection.sendMessagePromise({type:"hacs/repository/version",repository:r,version:i}));case 1:case"end":return t.stop()}}),t)})));return function(e,r,n){return t.apply(this,arguments)}}()},76646:function(t,e,r){r.d(e,{o:function(){return n}});var n=function(t){return"https://www.hacs.xyz".concat((null==t?void 0:t.path)||"")}},79372:function(t,e,r){var n=r(73155),i=r(33817),o=r(3429),a=r(75077);t.exports=function(t,e){e&&"string"==typeof t||i(t);var r=a(t);return o(i(void 0!==r?n(r,t):t))}},18684:function(t,e,r){var n=r(87568),i=r(42509),o=r(30356),a=r(51607),s=r(95124),c=r(79635);n({target:"Array",proto:!0},{flatMap:function(t){var e,r=a(this),n=s(r);return o(t),(e=c(r,0)).length=i(e,r,r,n,0,1,t,arguments.length>1?arguments[1]:void 0),e}})},74991:function(t,e,r){r(33523)("flatMap")},69704:function(t,e,r){var n=r(87568),i=r(73155),o=r(30356),a=r(33817),s=r(3429),c=r(79372),l=r(23408),u=r(44933),h=r(89385),d=l((function(){for(var t,e,r=this.iterator,n=this.mapper;;){if(e=this.inner)try{if(!(t=a(i(e.next,e.iterator))).done)return t.value;this.inner=null}catch(o){u(r,"throw",o)}if(t=a(i(this.next,r)),this.done=!!t.done)return;try{this.inner=c(n(t.value,this.counter++),!1)}catch(o){u(r,"throw",o)}}}));n({target:"Iterator",proto:!0,real:!0,forced:h},{flatMap:function(t){return a(this),o(t),new d(s(this),{mapper:t,inner:null})}})},44856:function(t,e,r){r.d(e,{N:function(){return o}});r(27934),r(77052),r(71936),r(43859),r(68113),r(55888);var n=function(t){var e=[];function r(r,n){t=n?r:Object.assign(Object.assign({},t),r);for(var i=e,o=0;o<i.length;o++)i[o](t)}return{get state(){return t},action:function(e){function n(t){r(t,!1)}return function(){for(var r=[t],i=0;i<arguments.length;i++)r.push(arguments[i]);var o=e.apply(this,r);if(null!=o)return o instanceof Promise?o.then(n):n(o)}},setState:r,clearState:function(){t=void 0},subscribe:function(t){return e.push(t),function(){!function(t){for(var r=[],n=0;n<e.length;n++)e[n]===t?t=null:r.push(e[n]);e=r}(t)}}}},i=function(t,e,r,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{unsubGrace:!0};if(t[e])return t[e];var a,s,c=0,l=n(),u=function(){if(!r)throw new Error("Collection does not support refresh");return r(t).then((function(t){return l.setState(t,!0)}))},h=function(){return u().catch((function(e){if(t.connected)throw e}))},d=function(){s=void 0,a&&a.then((function(t){t()})),l.clearState(),t.removeEventListener("ready",u),t.removeEventListener("disconnected",p)},p=function(){s&&(clearTimeout(s),d())};return t[e]={get state(){return l.state},refresh:u,subscribe:function(e){1===++c&&function(){if(void 0!==s)return clearTimeout(s),void(s=void 0);i&&(a=i(t,l)),r&&(t.addEventListener("ready",h),h()),t.addEventListener("disconnected",p)}();var n=l.subscribe(e);return void 0!==l.state&&setTimeout((function(){return e(l.state)}),0),function(){n(),--c||(o.unsubGrace?s=setTimeout(d,5e3):d())}}},t[e]},o=function(t,e,r,n,o){return i(n,t,e,r).subscribe(o)}},3358:function(t,e,r){r.d(e,{OA:function(){return n.OA},WL:function(){return n.WL},u$:function(){return n.u$}});var n=r(41611)}}]);
//# sourceMappingURL=1843.YXC_xzMJLMk.js.map