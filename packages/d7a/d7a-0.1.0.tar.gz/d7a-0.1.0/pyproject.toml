[project]
name = "d7a"
description = "Python Dash7 ALP library"
authors = [
    { name = "Glenn Ergeerts", email = "glenn.ergeerts@aloxy.io" },
    { name = "Liam Oorts", email = "liam.oorts@aloxy.io" },
    { name = "Kwinten Schram", email = "kwinten.schram@aloxy.io" },
    { name = "Dirk Van Haerenborgh", email = "dirk.vanhaerenborgh@aloxy.io" },
    { name = "Bart Jonkers", email = "bart.jonkers@aloxy.io" },
    { name = "Jolanta Tadla", email = "jolanta.tadla@aloxy.io" },
]
requires-python = ">=3.8,<4.0"
dependencies = [
    "bitstring>=3.1.7,<4.0.0",
    "cerberus>=1.3.5,<2.0.0",
    "jsonpickle>=3.0,<4.0",
    "crcmod>=1.7,<2.0",
]

readme = "README.md"
license = { text = "Apache-2.0" }
dynamic = ["version"]

[project.optional-dependencies]
examples = [
    "pyserial<4.0.0,>=3.5.0",
    "traceback2<2.0.0,>=1.4.0",
    "paho-mqtt<2.0.0,>=1.6.1",
]

[build-system]
requires = ["hatchling", "hatch-vcs"]
build-backend = "hatchling.build"

[tool.rye]
managed = true
dev-dependencies = [
    "ruff>=0.2.2",
    "pre-commit>=3.5",
    "pytest>=8.0.1",
    "pytest-cov>=4.1.0",
    "pyright>=1.1.351",
    "pytest-html>=4.1.1",
    "hatch-vcs>=0.4.0",
]

[tool.hatch.metadata]
allow-direct-references = true

[tool.hatch.version]
source = "vcs"

[tool.hatch.build.targets.wheel]
packages = ["d7a", "tools"]

[tool.pyright]
typeCheckingMode = "standard"
venvPath = "."
venv = ".venv"

[tool.ruff]
indent-width = 4
line-length = 140

[tool.ruff.format]
docstring-code-format = true

[tool.ruff.lint]
extend-select = [
    "E",   # pycodestyle
    "F",   # Pyflakes
    "UP",  # pyupgrade
    "B",   # flake8-bugbear
    "SIM", # flake8-simplify
    "I",   # isort
    "D",   # pydocstyle
]

ignore = [
    # pydocstyle ignore
    "D100", # Missing docstring in public module
    "D101", # Missing docstring in public class
    "D102", # Missing docstring in public method
    "D103", # Missing docstring in public function
    "D104", # Missing docstring in public package
    "D105", # Missing docstring in magic method
    "D106", # Missing docstring in public nested class
    "D107", # Missing docstring in `__init__`
]

[tool.ruff.lint.pydocstyle]
convention = "google"

[tool.pytest.ini_options]
minversion = "2.0"
addopts = "-rfEX -p pytester --strict-markers --doctest-modules"
norecursedirs = ["docs/scripts", "build", "dist"]
testpaths = ["test"]

[project.scripts]
"parse-hexstring" = "tools:parse_hexstring"

[tool.rye.scripts]
test = "pytest"
cov = "pytest --junitxml=test-report.xml --html=test-report.html --self-contained-html --cov --cov-report term --cov-report xml:coverage.xml --cov-report html:coverage"
